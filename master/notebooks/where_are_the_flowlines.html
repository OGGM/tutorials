
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OGGM flowlines: where are they? &#8212; OGGM tutorials</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Ingest gridded products such as ice velocity into OGGM (and compare them with the model output)" href="ingest_gridded_data_on_flowlines.html" />
    <link rel="prev" title="A quick look into the mass-balance calibration procedure" href="massbalance_calibration.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-106829797-2', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">OGGM tutorials</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="welcome.html">
   Welcome to the OGGM tutorials!
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Beginner tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="getting_started.html">
   Getting started with OGGM: a real case study, step by step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="working_with_rgi.html">
   Working with the RGI files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="store_and_compress_glacierdirs.html">
   Storing glacier directories for later use
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="elevation_bands_vs_centerlines.html">
   OGGM centerlines versus elevation-band flowlines: a quick comparison
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plot_mass_balance.html">
   Plotting the OGGM surface mass-balance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="area_length_filter.html">
   Filter the glacier length and area time series
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="run_with_gcm.html">
   Run OGGM with GCM data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="deal_with_errors.html">
   Dealing with errors after a run
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inversion.html">
   Ice thickness inversion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hydrological_output.html">
   Hydrological mass-balance output
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="oggm_shop.html">
   OGGM-Shop and Glacier Directories in OGGM
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Advanced tutorials
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="preprocessing_errors.html">
   Error analysis of the global pre-processing workflow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="run_with_a_spinup_and_gcm_data.html">
   Run with a spinup and GCM data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dem_sources.html">
   Create local topography maps from different DEM sources with OGGM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="thickness_model.html">
   A toy statistical model of ice thickness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inversion_with_frontal_ablation.html">
   Ice thickness inversion with frontal ablation: a case study
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kcalving_parameterization.html">
   The Oerlemans &amp; Nick frontal ablation parameterization in OGGM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="merging_glaciers.html">
   Merging glaciers for past climate simulations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="use_your_own_inventory.html">
   Using your our own glacier inventory with OGGM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="massbalance_calibration.html">
   A quick look into the mass-balance calibration procedure
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   OGGM flowlines: where are they?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ingest_gridded_data_on_flowlines.html">
   Ingest gridded products such as ice velocity into OGGM (and compare them with the model output)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Others
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="holoviz_intro.html">
   Small overview of HoloViz capability of data exploration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dem_comparison.html">
   Compare different DEMs for individual glaciers
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/where_are_the_flowlines.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/OGGM/tutorials"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/OGGM/tutorials/issues/new?title=Issue%20on%20page%20%2Fnotebooks/where_are_the_flowlines.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/OGGM/tutorials/edit/master/./notebooks/where_are_the_flowlines.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/OGGM/binder/stable?urlpath=git-pull%3Frepo=https://github.com/OGGM/tutorials%26urlpath%3Dlab%252Ftree%252Ftutorials/./notebooks/where_are_the_flowlines.ipynb%26branch%3Dmaster"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://hub.oggm.org/hub/user-redirect/git-pull?repo=https://github.com/OGGM/tutorials&urlpath=lab/tree/tutorials/./notebooks/where_are_the_flowlines.ipynb&branch=master"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#get-ready">
   Get ready
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#where-is-the-terminus-of-the-rgi-glacier">
   Where is the terminus of the RGI glacier?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#terminus-as-the-lowest-point-on-the-glacier">
     Terminus as the lowest point on the glacier
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#terminus-as-the-lowest-point-on-the-main-centerline">
     Terminus as the lowest point on the main centerline
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#terminus-as-the-lowest-point-on-the-main-flowline">
     Terminus as the lowest point on the main flowline
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bonus-convert-the-centerlines-to-a-shapefile">
     Bonus: convert the centerlines to a shapefile
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#flowline-geometry-after-a-run-with-the-new-flowline-diagnostics-new-in-v1-6-0">
   Flowline geometry after a run: with the new flowline diagnostics (new in v1.6.0!!)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#flowline-geometry-after-a-run-with-filemodel">
   Flowline geometry after a run: with
   <code class="docutils literal notranslate">
    <span class="pre">
     FileModel
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#location-of-the-terminus-over-time">
     Location of the terminus over time
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#comments-on-elevation-band-flowlines">
   Comments on “elevation band flowlines”
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-s-next">
   What’s next?
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="oggm-flowlines-where-are-they">
<h1>OGGM flowlines: where are they?<a class="headerlink" href="#oggm-flowlines-where-are-they" title="Permalink to this headline">¶</a></h1>
<p>In this notebook we show how to access the OGGM flowlines location before, during, and after a run.</p>
<p>Some of the code shown here will make it to the OGGM codebase <a class="reference external" href="https://github.com/OGGM/oggm/issues/1111">eventually</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">oggm</span> <span class="kn">import</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">utils</span><span class="p">,</span> <span class="n">workflow</span><span class="p">,</span> <span class="n">tasks</span><span class="p">,</span> <span class="n">graphics</span>
<span class="kn">from</span> <span class="nn">oggm.core</span> <span class="kn">import</span> <span class="n">flowline</span>
<span class="kn">import</span> <span class="nn">salem</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cfg</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">logging_level</span><span class="o">=</span><span class="s1">&#39;WARNING&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-11-08 09:10:59: oggm.cfg: Reading default parameters from the OGGM `params.cfg` configuration file.
2021-11-08 09:10:59: oggm.cfg: Multiprocessing switched OFF according to the parameter file.
2021-11-08 09:10:59: oggm.cfg: Multiprocessing: using all available processors (N=2)
</pre></div>
</div>
</div>
</div>
<div class="section" id="get-ready">
<h2>Get ready<a class="headerlink" href="#get-ready" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Where to store the data </span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;working_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(</span><span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;OGGM-flowlines&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Which glaciers?</span>
<span class="n">rgi_ids</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;RGI60-11.00897&#39;</span><span class="p">]</span>
<span class="c1"># We start from prepro level 3 with all data ready</span>
<span class="n">gdirs</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">init_glacier_directories</span><span class="p">(</span><span class="n">rgi_ids</span><span class="p">,</span> <span class="n">from_prepro_level</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">prepro_border</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">gdir</span> <span class="o">=</span> <span class="n">gdirs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">gdir</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-11-08 09:10:59: oggm.workflow: init_glacier_directories from prepro level 3 on 1 glaciers.
2021-11-08 09:10:59: oggm.workflow: Execute entity tasks [gdir_from_prepro] on 1 glaciers
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;oggm.GlacierDirectory&gt;
  RGI id: RGI60-11.00897
  Region: 11: Central Europe
  Subregion: 11-01: Alps                            
  Name: Hintereisferner
  Glacier type: Glacier
  Terminus type: Land-terminating
  Status: Glacier or ice cap
  Area: 8.036 km2
  Lon, Lat: (10.7584, 46.8003)
  Grid (nx, ny): (199, 154)
  Grid (dx, dy): (50.0, -50.0)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="where-is-the-terminus-of-the-rgi-glacier">
<h2>Where is the terminus of the RGI glacier?<a class="headerlink" href="#where-is-the-terminus-of-the-rgi-glacier" title="Permalink to this headline">¶</a></h2>
<p>There are several ways to get the terminus, depending on what you want. They are also not necessarily exact same:</p>
<div class="section" id="terminus-as-the-lowest-point-on-the-glacier">
<h3>Terminus as the lowest point on the glacier<a class="headerlink" href="#terminus-as-the-lowest-point-on-the-glacier" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the topo data and the glacier mask</span>
<span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">gdir</span><span class="o">.</span><span class="n">get_filepath</span><span class="p">(</span><span class="s1">&#39;gridded_data&#39;</span><span class="p">))</span> <span class="k">as</span> <span class="n">ds</span><span class="p">:</span>
    <span class="n">topo</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">topo</span>
    <span class="c1"># Glacier outline raster</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">glacier_ext</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">topo</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/where_are_the_flowlines_10_0.png" src="../_images/where_are_the_flowlines_10_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">topo_ext</span> <span class="o">=</span> <span class="n">topo</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
<span class="n">topo_ext</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/where_are_the_flowlines_11_0.png" src="../_images/where_are_the_flowlines_11_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the terminus</span>
<span class="n">terminus</span> <span class="o">=</span> <span class="n">topo_ext</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">topo_ext</span><span class="o">==</span><span class="n">topo_ext</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Project its coordinates from the local UTM to WGS-84</span>
<span class="n">t_lon</span><span class="p">,</span> <span class="n">t_lat</span> <span class="o">=</span> <span class="n">salem</span><span class="o">.</span><span class="n">transform_proj</span><span class="p">(</span><span class="n">gdir</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">proj</span><span class="p">,</span> <span class="s1">&#39;EPSG:4326&#39;</span><span class="p">,</span> <span class="n">terminus</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">terminus</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lon, lat:&#39;</span><span class="p">,</span> <span class="n">t_lon</span><span class="p">,</span> <span class="n">t_lat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;google link:&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;https://www.google.com/maps/place/</span><span class="si">{</span><span class="n">t_lat</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">t_lon</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>lon, lat: 10.802746863388563 46.818900914354266
google link: https://www.google.com/maps/place/46.818900914354266,10.802746863388563
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="terminus-as-the-lowest-point-on-the-main-centerline">
<h3>Terminus as the lowest point on the main centerline<a class="headerlink" href="#terminus-as-the-lowest-point-on-the-main-centerline" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the centerlines</span>
<span class="bp">cls</span> <span class="o">=</span> <span class="n">gdir</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;centerlines&#39;</span><span class="p">)</span>
<span class="c1"># Get the coord of the last point of the main centerline</span>
<span class="n">cl</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># These coords are in glacier grid coordinates. Let&#39;s convert them to lon, lat:</span>
<span class="n">t_lon</span><span class="p">,</span> <span class="n">t_lat</span> <span class="o">=</span> <span class="n">gdir</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">ij_to_crs</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:4326&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lon, lat:&#39;</span><span class="p">,</span> <span class="n">t_lon</span><span class="p">,</span> <span class="n">t_lat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;google link:&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;https://www.google.com/maps/place/</span><span class="si">{</span><span class="n">t_lat</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">t_lon</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>lon, lat: 10.802746863955196 46.818901155282155
google link: https://www.google.com/maps/place/46.818901155282155,10.802746863955196
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="terminus-as-the-lowest-point-on-the-main-flowline">
<h3>Terminus as the lowest point on the main flowline<a class="headerlink" href="#terminus-as-the-lowest-point-on-the-main-flowline" title="Permalink to this headline">¶</a></h3>
<p>“centerline” in the OGGM jargon is not the same as “flowline”. Flowlines have a fixed dx and their terminus is not necessarily exact on the glacier outline. Code-wise it’s very similar though:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the flowlines</span>
<span class="bp">cls</span> <span class="o">=</span> <span class="n">gdir</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;inversion_flowlines&#39;</span><span class="p">)</span>
<span class="c1"># Get the coord of the last point of the main centerline</span>
<span class="n">cl</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># These coords are in glacier grid coordinates. Let&#39;s convert them to lon, lat:</span>
<span class="n">t_lon</span><span class="p">,</span> <span class="n">t_lat</span> <span class="o">=</span> <span class="n">gdir</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">ij_to_crs</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:4326&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lon, lat:&#39;</span><span class="p">,</span> <span class="n">t_lon</span><span class="p">,</span> <span class="n">t_lat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;google link:&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;https://www.google.com/maps/place/</span><span class="si">{</span><span class="n">t_lat</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">t_lon</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>lon, lat: 10.802746777546085 46.818796056851475
google link: https://www.google.com/maps/place/46.818796056851475,10.802746777546085
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="bonus-convert-the-centerlines-to-a-shapefile">
<h3>Bonus: convert the centerlines to a shapefile<a class="headerlink" href="#bonus-convert-the-centerlines-to-a-shapefile" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_dir</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s1">&#39;outputs&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">write_centerlines_to_shape</span><span class="p">(</span><span class="n">gdirs</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s1">/centerlines.shp&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-11-08 09:11:01: oggm.utils: Applying global task write_centerlines_to_shape on 1 glaciers
2021-11-08 09:11:01: oggm.utils: write_centerlines_to_shape on outputs/centerlines.shp ...
2021-11-08 09:11:01: oggm.workflow: Execute entity tasks [_get_centerline_lonlat] on 1 glaciers
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/pyproj/crs/crs.py:131: FutureWarning: &#39;+init=&lt;authority&gt;:&lt;code&gt;&#39; syntax is deprecated. &#39;&lt;authority&gt;:&lt;code&gt;&#39; is the preferred initialization method. When making the change, be mindful of axis order changes: https://pyproj4.github.io/pyproj/stable/gotchas.html#axis-order-changes-in-proj-6
  in_crs_string = _prepare_from_proj_string(in_crs_string)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sh</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s1">/centerlines.shp&#39;</span><span class="p">)</span>
<span class="n">sh</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/where_are_the_flowlines_20_0.png" src="../_images/where_are_the_flowlines_20_0.png" />
</div>
</div>
<p>Remember: the “centerlines” are not the same things as “flowlines” in OGGM. The later objects undergo further quality checks, such as the impossibility for ice to “climb”, i.e. have negative slopes. The flowlines are therefore sometimes shorter than the centerlines:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">write_centerlines_to_shape</span><span class="p">(</span><span class="n">gdirs</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s1">/flowlines.shp&#39;</span><span class="p">,</span> <span class="n">flowlines_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sh</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s1">/flowlines.shp&#39;</span><span class="p">)</span>
<span class="n">sh</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-11-08 09:11:01: oggm.utils: Applying global task write_centerlines_to_shape on 1 glaciers
2021-11-08 09:11:01: oggm.utils: write_centerlines_to_shape on outputs/flowlines.shp ...
2021-11-08 09:11:01: oggm.workflow: Execute entity tasks [_get_centerline_lonlat] on 1 glaciers
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/pyproj/crs/crs.py:131: FutureWarning: &#39;+init=&lt;authority&gt;:&lt;code&gt;&#39; syntax is deprecated. &#39;&lt;authority&gt;:&lt;code&gt;&#39; is the preferred initialization method. When making the change, be mindful of axis order changes: https://pyproj4.github.io/pyproj/stable/gotchas.html#axis-order-changes-in-proj-6
  in_crs_string = _prepare_from_proj_string(in_crs_string)
</pre></div>
</div>
<img alt="../_images/where_are_the_flowlines_22_4.png" src="../_images/where_are_the_flowlines_22_4.png" />
</div>
</div>
</div>
</div>
<div class="section" id="flowline-geometry-after-a-run-with-the-new-flowline-diagnostics-new-in-v1-6-0">
<h2>Flowline geometry after a run: with the new flowline diagnostics (new in v1.6.0!!)<a class="headerlink" href="#flowline-geometry-after-a-run-with-the-new-flowline-diagnostics-new-in-v1-6-0" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO!!! Based on https://github.com/OGGM/oggm/pull/1308</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="flowline-geometry-after-a-run-with-filemodel">
<h2>Flowline geometry after a run: with <code class="docutils literal notranslate"><span class="pre">FileModel</span></code><a class="headerlink" href="#flowline-geometry-after-a-run-with-filemodel" title="Permalink to this headline">¶</a></h2>
<p>Let’s do a run first:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;store_model_geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># We want to get back to it later</span>

<span class="n">tasks</span><span class="o">.</span><span class="n">init_present_time_glacier</span><span class="p">(</span><span class="n">gdir</span><span class="p">)</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">run_constant_climate</span><span class="p">(</span><span class="n">gdir</span><span class="p">,</span> <span class="n">nyears</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mi">2000</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-11-08 09:11:02: oggm.cfg: PARAMS[&#39;store_model_geometry&#39;] changed from `False` to `True`.
</pre></div>
</div>
</div>
</div>
<p>We use a <code class="docutils literal notranslate"><span class="pre">FileModel</span></code> to read the model output:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fmod</span> <span class="o">=</span> <span class="n">flowline</span><span class="o">.</span><span class="n">FileModel</span><span class="p">(</span><span class="n">gdir</span><span class="o">.</span><span class="n">get_filepath</span><span class="p">(</span><span class="s1">&#39;model_geometry&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>A FileModel behaves like a OGGM’s <code class="docutils literal notranslate"><span class="pre">FlowlineModel</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fmod</span><span class="o">.</span><span class="n">run_until</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Point the file model to year 0 in the output</span>
<span class="n">graphics</span><span class="o">.</span><span class="n">plot_modeloutput_map</span><span class="p">(</span><span class="n">gdir</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">fmod</span><span class="p">)</span>  <span class="c1"># plot it</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/salem/graphics.py:1196: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  a = np.asarray(poly.exterior)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/descartes/patch.py:63: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  concatenate([asarray(t.exterior)[:, :2]] +
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/descartes/patch.py:64: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  [asarray(r)[:, :2] for r in t.interiors])
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
</pre></div>
</div>
<img alt="../_images/where_are_the_flowlines_31_1.png" src="../_images/where_are_the_flowlines_31_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fmod</span><span class="o">.</span><span class="n">run_until</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># Point the file model to year 100 in the output</span>
<span class="n">graphics</span><span class="o">.</span><span class="n">plot_modeloutput_map</span><span class="p">(</span><span class="n">gdir</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">fmod</span><span class="p">)</span>  <span class="c1"># plot it</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/salem/graphics.py:1196: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  a = np.asarray(poly.exterior)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/descartes/patch.py:63: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  concatenate([asarray(t.exterior)[:, :2]] +
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/descartes/patch.py:64: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  [asarray(r)[:, :2] for r in t.interiors])
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
/usr/local/pyenv/versions/3.9.7/lib/python3.9/site-packages/oggm/graphics.py:674: ShapelyDeprecationWarning: The array interface is deprecated and will no longer work in Shapely 2.0. Convert the &#39;.coords&#39; to a numpy array instead.
  smap.plot(ax)
</pre></div>
</div>
<img alt="../_images/where_are_the_flowlines_32_1.png" src="../_images/where_are_the_flowlines_32_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bonus - get back to e.g. the volume timeseries</span>
<span class="n">fmod</span><span class="o">.</span><span class="n">volume_km3_ts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/where_are_the_flowlines_33_0.png" src="../_images/where_are_the_flowlines_33_0.png" />
</div>
</div>
<p>OK, now create a table of the main flowline’s grid points location and bed altitude (this does not change with time):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fl</span> <span class="o">=</span> <span class="n">fmod</span><span class="o">.</span><span class="n">fls</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Main flowline</span>
<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">fl</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">xy</span>  <span class="c1"># xy flowline on grid</span>
<span class="n">lons</span><span class="p">,</span> <span class="n">lats</span> <span class="o">=</span> <span class="n">gdir</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">ij_to_crs</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:4326&#39;</span><span class="p">)</span>  <span class="c1"># to WGS84</span>

<span class="n">df_coords</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">fl</span><span class="o">.</span><span class="n">dis_on_line</span><span class="o">*</span><span class="n">gdir</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span>
<span class="n">df_coords</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Distance along flowline&#39;</span>
<span class="n">df_coords</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lons</span>
<span class="n">df_coords</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lats</span>
<span class="n">df_coords</span><span class="p">[</span><span class="s1">&#39;bed_elevation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fl</span><span class="o">.</span><span class="n">bed_h</span>
<span class="n">df_coords</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/where_are_the_flowlines_35_0.png" src="../_images/where_are_the_flowlines_35_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_coords</span><span class="p">[</span><span class="s1">&#39;bed_elevation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/where_are_the_flowlines_36_0.png" src="../_images/where_are_the_flowlines_36_0.png" />
</div>
</div>
<p>Now store a time varying array of ice thickness, surface elevation along this line:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">df_thick</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">df_coords</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">years</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">df_surf_h</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">df_coords</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">years</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">df_bed_h</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">:</span>
    <span class="n">fmod</span><span class="o">.</span><span class="n">run_until</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
    <span class="n">fl</span> <span class="o">=</span> <span class="n">fmod</span><span class="o">.</span><span class="n">fls</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">df_thick</span><span class="p">[</span><span class="n">year</span><span class="p">]</span> <span class="o">=</span> <span class="n">fl</span><span class="o">.</span><span class="n">thick</span>
    <span class="n">df_surf_h</span><span class="p">[</span><span class="n">year</span><span class="p">]</span> <span class="o">=</span> <span class="n">fl</span><span class="o">.</span><span class="n">surface_h</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_thick</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ice thickness at three points in time&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/where_are_the_flowlines_39_0.png" src="../_images/where_are_the_flowlines_39_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">df_surf_h</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
<span class="n">df_coords</span><span class="p">[</span><span class="s1">&#39;bed_elevation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Glacier elevation at three points in time&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/where_are_the_flowlines_40_0.png" src="../_images/where_are_the_flowlines_40_0.png" />
</div>
</div>
<div class="section" id="location-of-the-terminus-over-time">
<h3>Location of the terminus over time<a class="headerlink" href="#location-of-the-terminus-over-time" title="Permalink to this headline">¶</a></h3>
<p>Let’s find the indices where the terminus is (i.e. the last point where ice is thicker than 1m), and link these to the lon, lat positions along the flowlines.</p>
<p>The first method uses fancy pandas functions but may be more cryptic for less experienced pandas users:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Nice trick from https://stackoverflow.com/questions/34384349/find-index-of-last-true-value-in-pandas-series-or-dataframe</span>
<span class="n">dis_term</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_thick</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>

<span class="c1"># Select the terminus coordinates at these locations</span>
<span class="n">loc_over_time</span> <span class="o">=</span> <span class="n">df_coords</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dis_term</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">dis_term</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Plot them over time</span>
<span class="n">loc_over_time</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">loc_over_time</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Location of the terminus over time&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/where_are_the_flowlines_43_0.png" src="../_images/where_are_the_flowlines_43_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot them on a google image - you need an API key for this</span>
<span class="c1"># api_key = &#39;&#39;</span>
<span class="c1"># from motionless import DecoratedMap, LatLonMarker</span>
<span class="c1"># dmap = DecoratedMap(maptype=&#39;satellite&#39;, key=api_key)</span>
<span class="c1"># for y in [0, 20, 40, 60, 80, 100]:</span>
<span class="c1">#     tmp = loc_over_time.loc[y]</span>
<span class="c1">#     dmap.add_marker(LatLonMarker(tmp.lat, tmp.lon, ))</span>
<span class="c1"># print(dmap.generate_url())</span>
</pre></div>
</div>
</div>
</div>
<img src='https://maps.googleapis.com/maps/api/staticmap?key=AIzaSyDWG_aTgfU7CeErtIzWfdGxpStTlvDXV_o&maptype=satellite&format=png&scale=1&size=400x400&sensor=false&language=en&markers=%7C46.818796056851475%2C10.802746777546085%7C46.81537664036365%2C10.793672904092187%7C46.80792268953582%2C10.777563608554978%7C46.7953190811109%2C10.766412086223571%7C46.79236232808986%2C10.75236937607986%7C46.79236232808986%2C10.75236937607986'><p>And now, method 2: less fancy but maybe easier to read?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">yr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">]:</span>
    <span class="c1"># Find the last index of the terminus</span>
    <span class="n">p_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">df_thick</span><span class="p">[</span><span class="n">yr</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># Print the location of the terminus</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Terminus pos at year </span><span class="si">{</span><span class="n">yr</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">df_coords</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">p_term</span><span class="p">][[</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Terminus pos at year 0 [10.80274678 46.81879606]
Terminus pos at year 20 [10.7936729  46.81537664]
Terminus pos at year 40 [10.77756361 46.80792269]
Terminus pos at year 60 [10.76641209 46.79531908]
Terminus pos at year 80 [10.75236938 46.79236233]
Terminus pos at year 100 [10.75236938 46.79236233]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="comments-on-elevation-band-flowlines">
<h2>Comments on “elevation band flowlines”<a class="headerlink" href="#comments-on-elevation-band-flowlines" title="Permalink to this headline">¶</a></h2>
<p>If you use elevation band flowlines, the location of the flowlines is not known: indeed, the glacier is an even more simplified representation of the real world one. In this case, if you are interested in tracking the terminus position, you may need to use tricks, such as using the retreat from the terminus with time, or similar.</p>
</div>
<div class="section" id="what-s-next">
<h2>What’s next?<a class="headerlink" href="#what-s-next" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>return to the <a class="reference external" href="https://docs.oggm.org">OGGM documentation</a></p></li>
<li><p>back to the <a class="reference internal" href="welcome.html"><span class="doc std std-doc">table of contents</span></a></p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="massbalance_calibration.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">A quick look into the mass-balance calibration procedure</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="ingest_gridded_data_on_flowlines.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Ingest gridded products such as ice velocity into OGGM (and compare them with the model output)</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By OGGM e.V. and OGGM Contributors<br/>
        
          <div class="extra_footer">
            <p>
These notebooks are licensed under a <a href="https://github.com/OGGM/tutorials/blob/master/LICENSE.txt" target="_blank">BSD-3-Clause license</a>.
<br>
&copy; Copyright 2014-2021.
</p>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>