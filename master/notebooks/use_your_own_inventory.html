
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Using your our own glacier inventory with OGGM &#8212; OGGM tutorials</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="A quick look into different mass-balance calibration options" href="massbalance_calibration.html" />
    <link rel="prev" title="Merging glaciers for past climate simulations" href="merging_glaciers.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-106829797-2', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">OGGM tutorials</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="welcome.html">
                    Welcome to the OGGM tutorials!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  10 minutes tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="10minutes/run_with_gcm.html">
   10 minutes to… compute a projection with GCM data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10minutes/dynamical_spinup.html">
   10 minutes to… understand the new dynamical spinup in OGGM v1.6
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Beginner tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="getting_started.html">
   Getting started with OGGM: a real case study, step by step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="working_with_rgi.html">
   Working with the RGI files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="store_and_compress_glacierdirs.html">
   Storing glacier directories for later use
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="elevation_bands_vs_centerlines.html">
   OGGM centerlines versus elevation-band flowlines: a quick comparison
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plot_mass_balance.html">
   Plotting the OGGM surface mass-balance, the ELA and AAR
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="area_length_filter.html">
   Filter the glacier length and area time series
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="run_with_gcm.html">
   Run OGGM with GCM data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="deal_with_errors.html">
   Dealing with errors after a run
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inversion.html">
   Ice thickness inversion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hydrological_output.html">
   Hydrological mass-balance output
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="oggm_shop.html">
   OGGM-Shop and Glacier Directories in OGGM
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Advanced tutorials
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="preprocessing_errors.html">
   Error analysis of the global pre-processing workflow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="run_with_a_spinup_and_gcm_data.html">
   Run with a spinup and GCM data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dynamical_spinup.html">
   Dynamic spinup and dynamic
   <span class="math notranslate nohighlight">
    \(\mu^*\)
   </span>
   calibration for past simulations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dem_sources.html">
   Create local topography maps from different DEM sources with OGGM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="thickness_model.html">
   A toy statistical model of ice thickness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inversion_with_frontal_ablation.html">
   Ice thickness inversion with frontal ablation: a case study
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kcalving_parameterization.html">
   The Oerlemans &amp; Nick frontal ablation parameterization in OGGM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="merging_glaciers.html">
   Merging glaciers for past climate simulations
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Using your our own glacier inventory with OGGM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="massbalance_calibration.html">
   A quick look into different mass-balance calibration options
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="centerlines_to_shape.html">
   Compute smoother centerlines for shapefile output
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="where_are_the_flowlines.html">
   OGGM flowlines: where are they?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ingest_gridded_data_on_flowlines.html">
   Ingest gridded products such as ice velocity into OGGM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="merge_gcm_runs_and_visualize.html">
   Merge, analyse and visualize OGGM GCM runs
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Others
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="holoviz_intro.html">
   Small overview of HoloViz capability of data exploration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dem_comparison.html">
   Compare different DEMs for individual glaciers
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/OGGM/binder/stable?urlpath=git-pull%3Frepo=https://github.com/OGGM/tutorials%26urlpath%3Dlab%252Ftree%252Ftutorials/./notebooks/use_your_own_inventory.ipynb%26branch%3Dmaster"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://hub.oggm.org/hub/user-redirect/git-pull?repo=https%3A//github.com/OGGM/tutorials&urlpath=lab/tree/tutorials/./notebooks/use_your_own_inventory.ipynb&branch=master"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on JupyterHub"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/OGGM/tutorials"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/OGGM/tutorials/issues/new?title=Issue%20on%20page%20%2Fnotebooks/use_your_own_inventory.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/OGGM/tutorials/edit/master/./notebooks/use_your_own_inventory.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/notebooks/use_your_own_inventory.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tldr">
   TLDR;
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#structure-of-an-rgi-file">
   Structure of an RGI file
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#case-1-dividing-a-glacier-into-smaller-entities">
   Case 1: dividing a glacier into smaller entities
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#make-a-new-rgi-file">
     Make a new “RGI file”
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compute-the-intersects">
     Compute the intersects
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finally-the-oggm-run">
     Finally: the OGGM run
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#case-2-merging-glaciers">
   Case 2: merging glaciers
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#original-rgi-outlines">
     Original RGI outlines
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#let-s-merge-these-two-outlines-using-geopandas">
     Let’s merge these two outlines using geopandas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rgi-attributes">
     RGI attributes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-oggm-with-this-new-glacier">
     Run OGGM with this new glacier
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#case-3-start-from-a-completely-independent-inventory">
   Case 3: start from a completely independent inventory
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#note">
     Note:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-s-next">
   What’s next?
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Using your our own glacier inventory with OGGM</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tldr">
   TLDR;
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#structure-of-an-rgi-file">
   Structure of an RGI file
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#case-1-dividing-a-glacier-into-smaller-entities">
   Case 1: dividing a glacier into smaller entities
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#make-a-new-rgi-file">
     Make a new “RGI file”
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compute-the-intersects">
     Compute the intersects
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finally-the-oggm-run">
     Finally: the OGGM run
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#case-2-merging-glaciers">
   Case 2: merging glaciers
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#original-rgi-outlines">
     Original RGI outlines
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#let-s-merge-these-two-outlines-using-geopandas">
     Let’s merge these two outlines using geopandas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rgi-attributes">
     RGI attributes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-oggm-with-this-new-glacier">
     Run OGGM with this new glacier
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#case-3-start-from-a-completely-independent-inventory">
   Case 3: start from a completely independent inventory
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#note">
     Note:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-s-next">
   What’s next?
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="using-your-our-own-glacier-inventory-with-oggm">
<h1>Using your our own glacier inventory with OGGM<a class="headerlink" href="#using-your-our-own-glacier-inventory-with-oggm" title="Permalink to this headline">#</a></h1>
<p><a class="reference external" href="https://www.glims.org/RGI/">The Randolph Glacier Inventory</a> is a key dataset to model glaciers at any scale: it includes outlines of the extent of each glacier in the world, an information that is critical in figuring out how much a particular glacier might contribute to rising sea level. These glacier outlines are the starting point of any simulation in OGGM. The RGI’s latest version (v6), as well as v5, are provided and supported by OGGM (see the <a class="reference external" href="https://oggm.readthedocs.io/en/latest/input-data.html#glacier-outlines-and-intersects">documentation</a>). However, there are <a class="reference external" href="https://rgitools.readthedocs.io/en/latest/known-issues.html">several issues</a> in the RGI that might make you want to use your own corrected glacier outlines.</p>
<p>This notebook describes how to feed OGGM with them. We will show you three case studies about how to give any geometry to OGGM and avoid errors of incompatibility between your shapefile and the model framework.</p>
<p>We have three case studies which should cover a number of applications:</p>
<ol class="simple">
<li><p><a class="reference external" href="#case1">Dividing a glacier into smaller entities</a> (common case, useful for poorly outlined glaciers, which are in reality separate dynamical entities)</p></li>
<li><p><a class="reference external" href="#case2">Merging two glaciers together</a> (useful for tidewater glaciers in particular, not much elsewhere)</p></li>
<li><p><a class="reference external" href="#case3">Start from a completely independent inventory</a></p></li>
</ol>
<section id="tldr">
<h2>TLDR;<a class="headerlink" href="#tldr" title="Permalink to this headline">#</a></h2>
<p>If you want to use custom data to feed OGGM with, you should:</p>
<ul class="simple">
<li><p><strong>make a shapefile that resembles the RGI one: same attributes, and the glacier geometries should be in lon/lat projection</strong>. The most important attribute is <code class="docutils literal notranslate"><span class="pre">geometry</span></code>, of course, but others are used by OGGM as well: refer to <a class="reference external" href="https://docs.oggm.org/en/stable/input-data.html#glacier-outlines-and-intersects">the OGGM documentation</a> to decide which ones. The RGI documentation (found in the RGI directory after download) is useful as well! We also have a useful function (<code class="docutils literal notranslate"><span class="pre">oggm.utils.cook_rgidf</span></code>) which can help you with that.</p></li>
<li><p><strong>compute and use a new <a class="reference external" href="https://rgitools.readthedocs.io/en/latest/tools.html#glacier-intersects">glacier interesects</a> file</strong>, or make sure you don’t need one and disable this option in OGGM.</p></li>
</ul>
</section>
<section id="structure-of-an-rgi-file">
<h2>Structure of an RGI file<a class="headerlink" href="#structure-of-an-rgi-file" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">oggm</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">oggm</span> <span class="kn">import</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">utils</span><span class="p">,</span> <span class="n">workflow</span><span class="p">,</span> <span class="n">tasks</span><span class="p">,</span> <span class="n">graphics</span>
<span class="kn">from</span> <span class="nn">oggm.core</span> <span class="kn">import</span> <span class="n">inversion</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">logging_level</span><span class="o">=</span><span class="s1">&#39;WARNING&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-03-08 10:33:21: oggm.cfg: Reading default parameters from the OGGM `params.cfg` configuration file.
2023-03-08 10:33:21: oggm.cfg: Multiprocessing switched OFF according to the parameter file.
2023-03-08 10:33:21: oggm.cfg: Multiprocessing: using all available processors (N=2)
</pre></div>
</div>
</div>
</div>
<p>Let’s read a file from the standard RGI:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">get_rgi_dir</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="s1">&#39;61&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;/github/home/OGGM/rgi/RGIV61&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sh</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_rgi_region_file</span><span class="p">(</span><span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;61&#39;</span><span class="p">)</span>
<span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;/github/home/OGGM/rgi/RGIV61/11_rgi61_CentralEurope/11_rgi61_CentralEurope.shp&#39;
</pre></div>
</div>
</div>
</div>
<p>Shapefiles are best read an manipulated with <a class="reference external" href="http://geopandas.org/">geopandas</a> in python (see also our <a class="reference internal" href="working_with_rgi.html"><span class="doc std std-doc">working_with_rgi.ipynb</span></a> tutorial):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">sh</span><span class="p">)</span>
<span class="n">gdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RGIId</th>
      <th>GLIMSId</th>
      <th>BgnDate</th>
      <th>EndDate</th>
      <th>CenLon</th>
      <th>CenLat</th>
      <th>O1Region</th>
      <th>O2Region</th>
      <th>Area</th>
      <th>Zmin</th>
      <th>...</th>
      <th>Lmax</th>
      <th>Status</th>
      <th>Connect</th>
      <th>Form</th>
      <th>TermType</th>
      <th>Surging</th>
      <th>Linkages</th>
      <th>Name</th>
      <th>check_geom</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>RGI60-11.00001</td>
      <td>G013599E47495N</td>
      <td>20030799</td>
      <td>20030999</td>
      <td>13.5987</td>
      <td>47.4949</td>
      <td>11</td>
      <td>1</td>
      <td>0.122</td>
      <td>2191</td>
      <td>...</td>
      <td>461</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>POLYGON ((13.60035 47.49330, 13.59995 47.49332...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>RGI60-11.00002</td>
      <td>G013614E47485N</td>
      <td>20030799</td>
      <td>20030999</td>
      <td>13.6135</td>
      <td>47.4845</td>
      <td>11</td>
      <td>1</td>
      <td>2.292</td>
      <td>2203</td>
      <td>...</td>
      <td>1853</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>POLYGON ((13.60638 47.47578, 13.60599 47.47579...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>RGI60-11.00003</td>
      <td>G013596E47484N</td>
      <td>20030799</td>
      <td>20030999</td>
      <td>13.5960</td>
      <td>47.4835</td>
      <td>11</td>
      <td>1</td>
      <td>0.851</td>
      <td>2280</td>
      <td>...</td>
      <td>1140</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>POLYGON ((13.59765 47.47613, 13.59726 47.47614...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>RGI60-11.00004</td>
      <td>G013583E47481N</td>
      <td>20030799</td>
      <td>20030999</td>
      <td>13.5829</td>
      <td>47.4807</td>
      <td>11</td>
      <td>1</td>
      <td>0.053</td>
      <td>2319</td>
      <td>...</td>
      <td>382</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>POLYGON ((13.58283 47.47969, 13.58243 47.47971...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>RGI60-11.00005</td>
      <td>G013603E47477N</td>
      <td>20030799</td>
      <td>20030999</td>
      <td>13.6026</td>
      <td>47.4774</td>
      <td>11</td>
      <td>1</td>
      <td>0.057</td>
      <td>2656</td>
      <td>...</td>
      <td>202</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>POLYGON ((13.60076 47.47519, 13.60036 47.47521...</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div></div></div>
</div>
<p>An RGI file contains the actual glacier geometries, but also a number of attribute which are used by OGGM afterwards. Let’s learn how to make our own file now.</p>
<p><a id='case1'></a></p>
</section>
<section id="case-1-dividing-a-glacier-into-smaller-entities">
<h2>Case 1: dividing a glacier into smaller entities<a class="headerlink" href="#case-1-dividing-a-glacier-into-smaller-entities" title="Permalink to this headline">#</a></h2>
<p>A typical example of wrongly divided glacier is Hintereisferner, in Austria:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># OGGM set-up</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;working_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(</span><span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;rgi-case-1&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;border&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Get the HEF geometry and plot it</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_rgi_glacier_entities</span><span class="p">([</span><span class="s1">&#39;RGI60-11.00897&#39;</span><span class="p">])</span>
<span class="n">gl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-03-08 10:33:23: oggm.cfg: PARAMS[&#39;border&#39;] changed from `80` to `10`.
</pre></div>
</div>
<img alt="../_images/use_your_own_inventory_14_1.png" src="../_images/use_your_own_inventory_14_1.png" />
</div>
</div>
<p>Obviously, the two smaller tongues used to flow in the main one but this is not the case anymore today. We need updated geometries.</p>
<section id="make-a-new-rgi-file">
<h3>Make a new “RGI file”<a class="headerlink" href="#make-a-new-rgi-file" title="Permalink to this headline">#</a></h3>
<p>There is no simple way to automate the process of finding these bad geometries, but we are <a class="reference external" href="https://github.com/OGGM/partitioning">working on this</a> (don’t hold your breath, this has been in development since a long time). Here we use a geometry that we prepared in QGis:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We simulate the case where we only have the geometry, nothing else</span>
<span class="n">divides</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">get_demo_file</span><span class="p">(</span><span class="s1">&#39;divides_alps.shp&#39;</span><span class="p">))</span>
<span class="n">divides</span> <span class="o">=</span> <span class="n">divides</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">divides</span><span class="o">.</span><span class="n">RGIId</span> <span class="o">==</span> <span class="s1">&#39;RGI50-11.00897&#39;</span><span class="p">][[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]]</span>
<span class="n">divides</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>POLYGON ((10.74505 46.80376, 10.74610 46.80293...</td>
    </tr>
    <tr>
      <th>93</th>
      <td>POLYGON ((10.74860 46.80493, 10.74717 46.80529...</td>
    </tr>
    <tr>
      <th>94</th>
      <td>POLYGON ((10.74602 46.80561, 10.74717 46.80529...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">divides</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/use_your_own_inventory_19_0.png" src="../_images/use_your_own_inventory_19_0.png" />
</div>
</div>
<p>Now we use the RGI entity as template - it’s good to use the same attributes as the original RGI glacier, because most of them are already correct:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">gl</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">template</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RGIId</th>
      <th>GLIMSId</th>
      <th>BgnDate</th>
      <th>EndDate</th>
      <th>CenLon</th>
      <th>CenLat</th>
      <th>O1Region</th>
      <th>O2Region</th>
      <th>Area</th>
      <th>Zmin</th>
      <th>...</th>
      <th>Aspect</th>
      <th>Lmax</th>
      <th>Status</th>
      <th>Connect</th>
      <th>Form</th>
      <th>TermType</th>
      <th>Surging</th>
      <th>Linkages</th>
      <th>Name</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>RGI60-11.00897</td>
      <td>G010758E46800N</td>
      <td>20030799</td>
      <td>20030999</td>
      <td>10.7584</td>
      <td>46.8003</td>
      <td>11</td>
      <td>1</td>
      <td>8.036</td>
      <td>2430</td>
      <td>...</td>
      <td>71</td>
      <td>7178</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>1</td>
      <td>Hintereisferner</td>
      <td>POLYGON ((10.75085 46.81381, 10.75112 46.81397...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>RGI60-11.00897</td>
      <td>G010758E46800N</td>
      <td>20030799</td>
      <td>20030999</td>
      <td>10.7584</td>
      <td>46.8003</td>
      <td>11</td>
      <td>1</td>
      <td>8.036</td>
      <td>2430</td>
      <td>...</td>
      <td>71</td>
      <td>7178</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>1</td>
      <td>Hintereisferner</td>
      <td>POLYGON ((10.75085 46.81381, 10.75112 46.81397...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>RGI60-11.00897</td>
      <td>G010758E46800N</td>
      <td>20030799</td>
      <td>20030999</td>
      <td>10.7584</td>
      <td>46.8003</td>
      <td>11</td>
      <td>1</td>
      <td>8.036</td>
      <td>2430</td>
      <td>...</td>
      <td>71</td>
      <td>7178</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>1</td>
      <td>Hintereisferner</td>
      <td>POLYGON ((10.75085 46.81381, 10.75112 46.81397...</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 23 columns</p>
</div></div></div>
</div>
<p>We change the important ones:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Attributes</span>
<span class="n">template</span><span class="p">[</span><span class="s1">&#39;RGIId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;RGI60-11.00897_d01&#39;</span><span class="p">,</span> <span class="s1">&#39;RGI60-11.00897_d02&#39;</span><span class="p">,</span> <span class="s1">&#39;RGI60-11.00897_d03&#39;</span><span class="p">]</span>
<span class="n">template</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Hintereisferner d01&#39;</span><span class="p">,</span> <span class="s1">&#39;Hintereisferner d02&#39;</span><span class="p">,</span> <span class="s1">&#39;Hintereisferner d03&#39;</span><span class="p">]</span>
<span class="c1"># Geometries</span>
<span class="n">template</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">divides</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="c1"># Center point</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">geom</span> <span class="ow">in</span> <span class="n">template</span><span class="p">[[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">cenlon</span><span class="p">,</span> <span class="n">cenlat</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">xy</span>
    <span class="n">template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;CenLon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cenlon</span><span class="p">)</span>
    <span class="n">template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;CenLat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cenlat</span><span class="p">)</span>
<span class="c1"># This is important to properly georeference the file</span>
<span class="kn">import</span> <span class="nn">salem</span>
<span class="n">template</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">salem</span><span class="o">.</span><span class="n">wgs84</span><span class="o">.</span><span class="n">srs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/use_your_own_inventory_24_0.png" src="../_images/use_your_own_inventory_24_0.png" />
</div>
</div>
<p>Save it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hef_new_shape_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;working_dir&#39;</span><span class="p">],</span> <span class="s1">&#39;hef_divided.shp&#39;</span><span class="p">)</span>
<span class="n">template</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">hef_new_shape_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-the-intersects">
<h3>Compute the intersects<a class="headerlink" href="#compute-the-intersects" title="Permalink to this headline">#</a></h3>
<p>Hintereisferner has a divide with another glacier as well! Let’s find out which:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">intersects_alps</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">get_rgi_intersects_region_file</span><span class="p">(</span><span class="s1">&#39;11&#39;</span><span class="p">))</span>
<span class="n">intersects_hef</span> <span class="o">=</span> <span class="n">intersects_alps</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">intersects_alps</span><span class="o">.</span><span class="n">RGIId_1</span> <span class="o">==</span> <span class="s1">&#39;RGI60-11.00897&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">intersects_alps</span><span class="o">.</span><span class="n">RGIId_2</span> <span class="o">==</span> <span class="s1">&#39;RGI60-11.00897&#39;</span><span class="p">)]</span>
<span class="n">intersects_hef</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RGIId_1</th>
      <th>RGIId_2</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>119</th>
      <td>RGI60-11.00846</td>
      <td>RGI60-11.00897</td>
      <td>LINESTRING (10.74826 46.81077, 10.74840 46.810...</td>
    </tr>
    <tr>
      <th>143</th>
      <td>RGI60-11.00897</td>
      <td>RGI60-11.00846</td>
      <td>LINESTRING (10.72557 46.79781, 10.72557 46.797...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ok, we can now create a file which has all the glaciers we need to compute the relevant intersects (note that we could also use the full standard RGI with just HEF replaced):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">for_intersects</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">template</span><span class="p">,</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_rgi_glacier_entities</span><span class="p">([</span><span class="s1">&#39;RGI60-11.00846&#39;</span><span class="p">])],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">for_intersects</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">salem</span><span class="o">.</span><span class="n">wgs84</span><span class="o">.</span><span class="n">srs</span>
<span class="n">for_intersects</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">for_intersects</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">template</span><span class="p">,</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_rgi_glacier_entities</span><span class="p">([</span><span class="s1">&#39;RGI60-11.00846&#39;</span><span class="p">])],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">for_intersects</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">salem</span><span class="o">.</span><span class="n">wgs84</span><span class="o">.</span><span class="n">srs</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">for_intersects</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">);</span>

<span class="nn">File /usr/local/pyenv/versions/3.10.10/lib/python3.10/site-packages/pandas/util/_decorators.py:331,</span> in <span class="ni">deprecate_nonkeyword_arguments.&lt;locals&gt;.decorate.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">325</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">num_allow_args</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">326</span>     <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">327</span>         <span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arguments</span><span class="o">=</span><span class="n">_format_argument_list</span><span class="p">(</span><span class="n">allow_args</span><span class="p">)),</span>
<span class="g g-Whitespace">    </span><span class="mi">328</span>         <span class="ne">FutureWarning</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">329</span>         <span class="n">stacklevel</span><span class="o">=</span><span class="n">find_stack_level</span><span class="p">(),</span>
<span class="g g-Whitespace">    </span><span class="mi">330</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">331</span> <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File /usr/local/pyenv/versions/3.10.10/lib/python3.10/site-packages/pandas/core/reshape/concat.py:381,</span> in <span class="ni">concat</span><span class="nt">(objs, axis, join, ignore_index, keys, levels, names, verify_integrity, sort, copy)</span>
<span class="g g-Whitespace">    </span><span class="mi">159</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">160</span><span class="sd"> Concatenate pandas objects along a particular axis.</span>
<span class="g g-Whitespace">    </span><span class="mi">161</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">366</span><span class="sd"> 1   3   4</span>
<span class="g g-Whitespace">    </span><span class="mi">367</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">368</span> <span class="n">op</span> <span class="o">=</span> <span class="n">_Concatenator</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">369</span>     <span class="n">objs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">370</span>     <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">378</span>     <span class="n">sort</span><span class="o">=</span><span class="n">sort</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">379</span> <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">381</span> <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">get_result</span><span class="p">()</span>

<span class="nn">File /usr/local/pyenv/versions/3.10.10/lib/python3.10/site-packages/pandas/core/reshape/concat.py:616,</span> in <span class="ni">_Concatenator.get_result</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">612</span>             <span class="n">indexers</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj_labels</span><span class="o">.</span><span class="n">get_indexer</span><span class="p">(</span><span class="n">new_labels</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">614</span>     <span class="n">mgrs_indexers</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">obj</span><span class="o">.</span><span class="n">_mgr</span><span class="p">,</span> <span class="n">indexers</span><span class="p">))</span>
<span class="ne">--&gt; </span><span class="mi">616</span> <span class="n">new_data</span> <span class="o">=</span> <span class="n">concatenate_managers</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">617</span>     <span class="n">mgrs_indexers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_axes</span><span class="p">,</span> <span class="n">concat_axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bm_axis</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">copy</span>
<span class="g g-Whitespace">    </span><span class="mi">618</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">619</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">620</span>     <span class="n">new_data</span><span class="o">.</span><span class="n">_consolidate_inplace</span><span class="p">()</span>

<span class="nn">File /usr/local/pyenv/versions/3.10.10/lib/python3.10/site-packages/pandas/core/internals/concat.py:226,</span> in <span class="ni">concatenate_managers</span><span class="nt">(mgrs_indexers, axes, concat_axis, copy)</span>
<span class="g g-Whitespace">    </span><span class="mi">223</span>     <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">224</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span>     <span class="c1"># TODO(EA2D): special-casing not needed with 2D EAs</span>
<span class="ne">--&gt; </span><span class="mi">226</span>     <span class="n">values</span> <span class="o">=</span> <span class="n">concat_compat</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">227</span>     <span class="n">values</span> <span class="o">=</span> <span class="n">ensure_block_shape</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">229</span> <span class="n">values</span> <span class="o">=</span> <span class="n">ensure_wrapped_if_datetimelike</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

<span class="nn">File /usr/local/pyenv/versions/3.10.10/lib/python3.10/site-packages/pandas/core/dtypes/concat.py:133,</span> in <span class="ni">concat_compat</span><span class="nt">(to_concat, axis, ea_compat_axis)</span>
<span class="g g-Whitespace">    </span><span class="mi">130</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to_concat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ABCExtensionArray</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">131</span>     <span class="c1"># TODO: what about EA-backed Index?</span>
<span class="g g-Whitespace">    </span><span class="mi">132</span>     <span class="bp">cls</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">to_concat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="ne">--&gt; </span><span class="mi">133</span>     <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_concat_same_type</span><span class="p">(</span><span class="n">to_concat</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">134</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">135</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">to_concat</span><span class="p">)</span>

<span class="nn">File /usr/local/pyenv/versions/3.10.10/lib/python3.10/site-packages/geopandas/array.py:1323,</span> in <span class="ni">GeometryArray._concat_same_type</span><span class="nt">(cls, to_concat)</span>
<span class="g g-Whitespace">   </span><span class="mi">1311</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1312</span><span class="sd"> Concatenate multiple array</span>
<span class="g g-Whitespace">   </span><span class="mi">1313</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">1320</span><span class="sd"> ExtensionArray</span>
<span class="g g-Whitespace">   </span><span class="mi">1321</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1322</span> <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">ga</span><span class="o">.</span><span class="n">data</span> <span class="k">for</span> <span class="n">ga</span> <span class="ow">in</span> <span class="n">to_concat</span><span class="p">])</span>
<span class="ne">-&gt; </span><span class="mi">1323</span> <span class="k">return</span> <span class="n">GeometryArray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">_get_common_crs</span><span class="p">(</span><span class="n">to_concat</span><span class="p">))</span>

<span class="nn">File /usr/local/pyenv/versions/3.10.10/lib/python3.10/site-packages/geopandas/array.py:1413,</span> in <span class="ni">_get_common_crs</span><span class="nt">(arr_seq)</span>
<span class="g g-Whitespace">   </span><span class="mi">1406</span>         <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1407</span>             <span class="s2">&quot;CRS not set for some of the concatenation inputs. &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1408</span>             <span class="sa">f</span><span class="s2">&quot;Setting output&#39;s CRS as </span><span class="si">{</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1409</span>             <span class="s2">&quot;(the single non-null crs provided).&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1410</span>         <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1411</span>     <span class="k">return</span> <span class="n">crs_not_none</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="ne">-&gt; </span><span class="mi">1413</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1414</span>     <span class="sa">f</span><span class="s2">&quot;Cannot determine common CRS for concatenation inputs, got </span><span class="si">{</span><span class="n">names</span><span class="si">}</span><span class="s2">. &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1415</span>     <span class="s2">&quot;Use `to_crs()` to transform geometries to the same CRS before merging.&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1416</span> <span class="p">)</span>

<span class="ne">ValueError</span>: Cannot determine common CRS for concatenation inputs, got [&#39;WGS 84&#39;, &#39;unknown&#39;]. Use `to_crs()` to transform geometries to the same CRS before merging.
</pre></div>
</div>
</div>
</div>
<p>Good! Let’s use <a class="reference external" href="https://rgitools.readthedocs.io">rgitools</a> to compute the intersects for this new situation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rgitools.funcs</span> <span class="kn">import</span> <span class="n">compute_intersects</span>
<span class="n">new_intersects</span> <span class="o">=</span> <span class="n">compute_intersects</span><span class="p">(</span><span class="n">for_intersects</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If this raises an error, you might have to install <a class="reference external" href="https://rgitools.readthedocs.io">rgitools</a> first (e.g. <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">git+https://github.com/OGGM/rgitools.git</span></code>)
and also <a class="reference external" href="https://networkx.org/documentation/stable/index.html">networkx</a> (<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">networkx</span></code>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">for_intersects</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">);</span>
<span class="n">new_intersects</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Good! We can store our intersects to use them with OGGM afterwards:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hef_intersects_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;working_dir&#39;</span><span class="p">],</span> <span class="s1">&#39;hef_divided_intersects.shp&#39;</span><span class="p">)</span>
<span class="n">new_intersects</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">hef_intersects_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="finally-the-oggm-run">
<h3>Finally: the OGGM run<a class="headerlink" href="#finally-the-oggm-run" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is important! We tell OGGM to recompute the glacier area for us</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;use_rgi_area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1"># This is the default anyway, but we set it here to be sure</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;use_intersects&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># This is important!</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">set_intersects_db</span><span class="p">(</span><span class="n">hef_intersects_path</span><span class="p">)</span>

<span class="c1"># This is to avoid a download in the tutorial, you dont&#39; need do this at home</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;dem_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_demo_file</span><span class="p">(</span><span class="s1">&#39;hef_srtm.tif&#39;</span><span class="p">)</span>

<span class="c1"># This is important again - standard OGGM </span>
<span class="n">rgidf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">hef_new_shape_path</span><span class="p">)</span>
<span class="n">gdirs</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">init_glacier_directories</span><span class="p">(</span><span class="n">rgidf</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">workflow</span><span class="o">.</span><span class="n">execute_entity_task</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">define_glacier_region</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">);</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">execute_entity_task</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">glacier_masks</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">);</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">execute_entity_task</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">compute_centerlines</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">);</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">execute_entity_task</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">initialize_flowlines</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">);</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">execute_entity_task</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">catchment_area</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">);</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">execute_entity_task</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">catchment_width_geom</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">);</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">execute_entity_task</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">catchment_width_correction</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>If you get “NameError ‘skdraw’ is not defined”, you have to install the python image processing package <a class="reference external" href="https://scikit-image.org/docs/stable/install.html#installation-via-pip-and-conda">scikit-image</a> first (e.g. via <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">scikit-image</span></code>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_catchment_width</span><span class="p">(</span><span class="n">gdirs</span><span class="p">,</span> <span class="n">add_intersects</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">corrected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>It works!</p>
<p><strong>The intersects in OGGM are used for two main things:</strong></p>
<ul class="simple">
<li><p>when a grid-point glacier section touches an intersect, it will be attributed a rectangular bed (instead of a parabolic one)</p></li>
<li><p>when interpolating the ice thickness to a 2D grid, the boundary condition thickness=0 at the glacier outline is removed where there are intersects</p></li>
</ul>
<p><strong>We recommend to use intersects for your runs as well.</strong></p>
<p><a id='case2'></a></p>
</section>
</section>
<section id="case-2-merging-glaciers">
<h2>Case 2: merging glaciers<a class="headerlink" href="#case-2-merging-glaciers" title="Permalink to this headline">#</a></h2>
<p>Sometimes, you may want to <em>merge</em> glaciers together. This case is less frequent than Case 1, but might be useful for calving glaciers, which are sometimes divided in the RGI.</p>
<section id="original-rgi-outlines">
<h3>Original RGI outlines<a class="headerlink" href="#original-rgi-outlines" title="Permalink to this headline">#</a></h3>
<p>We use a case study for two marine-terminating glaciers in Alaska that have to be merged into a single outline in order to model a correct calving flux for these glaciers (following the methods described in
<a class="reference external" href="https://www.the-cryosphere.net/13/2657/2019/tc-13-2657-2019.html">Recinos et al., (2019)</a>). The resulting shapefile is a new one that needs to be adapted in order for OGGM to run.</p>
<p>We will study the Sawyer Glacier (<code class="docutils literal notranslate"><span class="pre">RGI60-01.03890</span></code>) that is actually connected via the calving front with this other entity (<code class="docutils literal notranslate"><span class="pre">RGI60-01.23664</span></code>). Visit this <a class="reference external" href="https://glacierchange.wordpress.com/2011/03/16/saywer-glacier-alaska-retreat/">link</a> to learn more about the retreat of the Sawyer Glacier and see images illustrating this connection.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gl</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_rgi_glacier_entities</span><span class="p">([</span><span class="s1">&#39;RGI60-01.03890&#39;</span><span class="p">,</span> <span class="s1">&#39;RGI60-01.23664&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Here OGGM downloaded the outlines for both glaciers. If we plot them together, we can see that both glaciers drain into the same fjord. See the google map below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cfg</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">logging_level</span><span class="o">=</span><span class="s1">&#39;WARNING&#39;</span><span class="p">)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;working_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(</span><span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;rgi-case-2-example&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;border&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">gdirs</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">init_glacier_directories</span><span class="p">([</span><span class="s1">&#39;RGI60-01.03890&#39;</span><span class="p">,</span> <span class="s1">&#39;RGI60-01.23664&#39;</span><span class="p">],</span> <span class="n">from_prepro_level</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">graphics</span><span class="o">.</span><span class="n">plot_googlemap</span><span class="p">(</span><span class="n">gdirs</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<p>The upper glacier map is a zoom version of the plot below.
They share the same glaciers terminus. Therefore, to estimate a calving flux for these glaciers we need them connected.</p>
</section>
<section id="let-s-merge-these-two-outlines-using-geopandas">
<h3>Let’s merge these two outlines using geopandas<a class="headerlink" href="#let-s-merge-these-two-outlines-using-geopandas" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">dissolve</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;O2Region&#39;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
<span class="n">merged</span> <span class="o">=</span> <span class="n">merged</span><span class="p">[</span><span class="n">gl</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="n">merged</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="rgi-attributes">
<h3>RGI attributes<a class="headerlink" href="#rgi-attributes" title="Permalink to this headline">#</a></h3>
<p>We now have a new shapefile, which resembles an RGI one but has wrong attributes. Some aren’t relevant, but some are. See the <a class="reference external" href="https://oggm.readthedocs.io/en/latest/input-data.html#glacier-outlines-and-intersects">documentation</a> for a list.</p>
<p>The important ones are: RGIId, CenLon, CenLat, TermType, Area. Area and CenLon, Cenlat can be calculated by OGGM later, as we have seen earlier. Here, we prefer to keep the Area computed by the RGI for consistency.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We use the RGI as template (this avoids strange IO issues)</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">template</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change CenLon, CenLat</span>
<span class="n">cenlon</span><span class="p">,</span> <span class="n">cenlat</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">representative_point</span><span class="p">()</span><span class="o">.</span><span class="n">xy</span>
<span class="n">template</span><span class="p">[</span><span class="s1">&#39;CenLon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cenlon</span>
<span class="n">template</span><span class="p">[</span><span class="s1">&#39;CenLat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cenlat</span>

<span class="c1"># We sum up the areas</span>
<span class="n">template</span><span class="p">[</span><span class="s1">&#39;Area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">Area</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">template</span><span class="p">[</span><span class="s1">&#39;Area&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>In <a class="reference external" href="https://www.the-cryosphere.net/13/2657/2019/tc-13-2657-2019.html">Recinos et al., (2019)</a> we wanted to estimate a frontal ablation flux for this new outline and compare it with previous estimates found in the literature for the Sawyer Glacier (<a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1002/2014JF003276">McNabb et al., 2015</a>).</p>
<p>For this reason we kept the Sawyer glacier attributes to the following variables:
<code class="docutils literal notranslate"><span class="pre">RGIId,</span> <span class="pre">GLIMSId,</span> <span class="pre">Name</span></code></p>
<p>The <code class="docutils literal notranslate"><span class="pre">TermType</span></code> should be equal to 1, for Marine-terminating.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="p">[</span><span class="s1">&#39;TermType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">template</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Sawyer Glacier merged with RGI60-01.23664&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can write a new shapefile for this glacier.
We recommend doing this if you have to make several model runs. You can also integrate this outline to your main RGI shapefile:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cfg</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;working_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(</span><span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;rgi-case-2&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">template</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">salem</span><span class="o">.</span><span class="n">wgs84</span><span class="o">.</span><span class="n">srs</span>
<span class="n">template</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;working_dir&#39;</span><span class="p">],</span> <span class="s1">&#39;merged.shp&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-oggm-with-this-new-glacier">
<h3>Run OGGM with this new glacier<a class="headerlink" href="#run-oggm-with-this-new-glacier" title="Permalink to this headline">#</a></h3>
<p>For simplicity, we do not compute the intersects in this case: <strong>however, we recommend you do do so (see above). In all cases, do not use the intersects provided automatically with OGGM when using custom inventories, as they are likely to be wrong.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set-up the run</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;border&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># We don&#39;t use intersects here</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;use_intersects&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># We prefer OGGM to use the area we computed ourselves</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;use_rgi_area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># Use our merged file</span>
<span class="n">rgidf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;working_dir&#39;</span><span class="p">],</span> <span class="s1">&#39;merged.shp&#39;</span><span class="p">))</span>
<span class="n">gdirs</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">init_glacier_directories</span><span class="p">(</span><span class="n">rgidf</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gdirs</span>
</pre></div>
</div>
</div>
</div>
<p>Here we are not able to use the <a class="reference external" href="https://docs.oggm.org/en/stable/input-data.html#pre-processed-directories">Pre-processed directories</a> and the respective <a class="reference external" href="https://docs.oggm.org/en/stable/input-data.html#preprodir">Processing levels</a> that OGGM provides for a easy run set up. We can’t use this workflow simply because we have a different beginning than OGGM, we have a different RGI! We just need to type more and run all the model task one by one:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">oggm.workflow</span> <span class="kn">import</span> <span class="n">execute_entity_task</span>

<span class="c1"># Calculate the DEMs and the masks</span>
<span class="n">execute_entity_task</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">define_glacier_region</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">,</span> <span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;SRTM&#39;</span><span class="p">)</span>
<span class="n">execute_entity_task</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">glacier_masks</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">)</span>

<span class="c1"># Calculate the Pre-processing tasks</span>
<span class="n">task_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">tasks</span><span class="o">.</span><span class="n">compute_centerlines</span><span class="p">,</span>
    <span class="n">tasks</span><span class="o">.</span><span class="n">initialize_flowlines</span><span class="p">,</span>
    <span class="n">tasks</span><span class="o">.</span><span class="n">catchment_area</span><span class="p">,</span>
    <span class="n">tasks</span><span class="o">.</span><span class="n">catchment_width_geom</span><span class="p">,</span>
    <span class="n">tasks</span><span class="o">.</span><span class="n">catchment_width_correction</span><span class="p">,</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">task_list</span><span class="p">:</span>
    <span class="n">execute_entity_task</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>note that we used in <code class="docutils literal notranslate"><span class="pre">tasks.define_glacier_region</span></code> SRTM as DEM source which is not the default one in OGGM.
The default one is NASADEM, but for that you have to register at <a class="reference external" href="https://urs.earthdata.nasa.gov/">NASA Earthdata</a>
more info in <a class="reference external" href="dem_sources.ipynb#register">dem_sources.ipynb/register</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_googlemap</span><span class="p">(</span><span class="n">gdirs</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_catchment_width</span><span class="p">(</span><span class="n">gdirs</span><span class="p">,</span> <span class="n">corrected</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p><a id='case3'></a></p>
</section>
</section>
<section id="case-3-start-from-a-completely-independent-inventory">
<h2>Case 3: start from a completely independent inventory<a class="headerlink" href="#case-3-start-from-a-completely-independent-inventory" title="Permalink to this headline">#</a></h2>
<p>OGGM (since version 1.5.3) now offers a function (<code class="docutils literal notranslate"><span class="pre">utils.cook_rgidf()</span></code>) to make it easier of using a non-RGI glacier inventory in OGGM. Now, let’s use a non-RGI glacier inventory from the second Chinese glacier inventory (CGI2, <a class="reference external" href="https://doi.org/10.3189/2015JoG14J209">https://doi.org/10.3189/2015JoG14J209</a>) to show how it works.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s get the sample CGI2 glacier inventory and see what it looks like</span>
<span class="kn">from</span> <span class="nn">oggm</span> <span class="kn">import</span> <span class="n">utils</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="n">cgidf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">get_demo_file</span><span class="p">(</span><span class="s1">&#39;cgi2.shp&#39;</span><span class="p">))</span>
<span class="n">cgidf</span>
</pre></div>
</div>
</div>
</div>
<p>Ha! There are some Chinese characters! But it should not influence our work. Now, let’s try with the simplest case:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rgidf_simple</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">cook_rgidf</span><span class="p">(</span><span class="n">cgidf</span><span class="p">,</span> <span class="n">o1_region</span><span class="o">=</span><span class="s1">&#39;13&#39;</span><span class="p">)</span>
<span class="n">rgidf_simple</span>
</pre></div>
</div>
</div>
</div>
<p>In this case, we fake all of the columns values except for <code class="docutils literal notranslate"><span class="pre">geometry</span></code>. With this <code class="docutils literal notranslate"><span class="pre">rgidf_simple</span></code>, we can handle most of the OGGM procedure after set <code class="docutils literal notranslate"><span class="pre">cfg.PARAMS['use_rgi_area']</span> <span class="pre">=</span> <span class="pre">False</span></code>. Let’s have a try:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">oggm</span> <span class="kn">import</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">workflow</span>

<span class="n">cfg</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;use_multiprocessing&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;use_rgi_area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;use_intersects&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;working_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(</span><span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;cook_rgidf&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gdirs</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">init_glacier_directories</span><span class="p">(</span><span class="n">rgidf_simple</span><span class="p">)</span>

<span class="c1"># The tasks below require downloading new data - we comment them for the tutorial, but it should work for you!</span>
<span class="c1"># workflow.gis_prepro_tasks(gdirs)</span>
<span class="c1"># workflow.download_ref_tstars(&#39;https://cluster.klima.uni-bremen.de/~oggm/ref_mb_params/oggm_v1.4/RGIV62/CRU/centerlines/qc3/pcp2.5&#39;)</span>
<span class="c1"># workflow.climate_tasks(gdirs)</span>
<span class="c1"># workflow.inversion_tasks(gdirs)</span>

<span class="n">utils</span><span class="o">.</span><span class="n">compile_glacier_statistics</span><span class="p">(</span><span class="n">gdirs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Sometimes, the information in the original glacier inventory also covered what RGI need, but with different name. For example, both CGI2 and RGI include Lon-lat coordinate to indicate the location of the glacier but with different names. CGI2 used <code class="docutils literal notranslate"><span class="pre">Glc_Long</span></code> and <code class="docutils literal notranslate"><span class="pre">Glc_Lati</span></code>, while RGI6 used <code class="docutils literal notranslate"><span class="pre">CenLon</span></code> and <code class="docutils literal notranslate"><span class="pre">CenLat</span></code>. Also, CGI2 include glacier area information with name <code class="docutils literal notranslate"><span class="pre">Glc_Area</span></code>, while RGI named glacier area as <code class="docutils literal notranslate"><span class="pre">Area</span></code>. If we want to keep those values but rename them following RGI, we can use the <code class="docutils literal notranslate"><span class="pre">assign_column_values</span></code> keyword argument:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rgidf_save_columns</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">cook_rgidf</span><span class="p">(</span><span class="n">cgidf</span><span class="p">,</span> <span class="n">o1_region</span><span class="o">=</span><span class="s1">&#39;13&#39;</span><span class="p">,</span> <span class="n">assign_column_values</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Glc_Long&#39;</span><span class="p">:</span> <span class="s1">&#39;CenLon&#39;</span><span class="p">,</span> <span class="s1">&#39;Glc_Lati&#39;</span><span class="p">:</span> <span class="s1">&#39;CenLat&#39;</span><span class="p">,</span> <span class="s1">&#39;Glc_Area&#39;</span><span class="p">:</span> <span class="s1">&#39;Area&#39;</span><span class="p">,</span> <span class="s1">&#39;GLIMS_ID&#39;</span><span class="p">:</span> <span class="s1">&#39;GLIMSId&#39;</span><span class="p">})</span>
<span class="n">rgidf_save_columns</span>
</pre></div>
</div>
</div>
</div>
<p>Seems perfect! However, the glacier area in CGI2 is in <span class="math notranslate nohighlight">\(m^2\)</span>, but it is in <span class="math notranslate nohighlight">\(km^2\)</span> for RGI. So, we need to correct the <code class="docutils literal notranslate"><span class="pre">Area</span></code> values right:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rgidf_save_columns</span><span class="p">[</span><span class="s1">&#39;Area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rgidf_save_columns</span><span class="o">.</span><span class="n">Area</span> <span class="o">*</span> <span class="mf">1e-6</span>
<span class="n">rgidf_save_columns</span><span class="o">.</span><span class="n">Area</span>
</pre></div>
</div>
</div>
</div>
<section id="note">
<h3>Note:<a class="headerlink" href="#note" title="Permalink to this headline">#</a></h3>
<p>Despite that <code class="docutils literal notranslate"><span class="pre">cook_rgidf()</span></code> can handle most of the cases for OGGM, there are some limitations. Here, we try to point out some of cases in which the <code class="docutils literal notranslate"><span class="pre">rgidf</span></code> sourced from <code class="docutils literal notranslate"><span class="pre">cook_rgidf()</span></code> might get you in trouble:</p>
<ul class="simple">
<li><p>in <code class="docutils literal notranslate"><span class="pre">cook_rgidf()</span></code>, we assign the glacier form with ‘0’ (Glacier) for all of the glaciers in the original data. OGGM assigns different parameters for glaciers (form ‘0’) and ice caps (form ‘1’).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">termtype</span></code> was also assign as ‘0’ which means ‘land-terminating’. Here again, OGGM treats ‘Marine-terminating’ glaciers differently (see <a class="reference external" href="https://docs.oggm.org/en/stable/frontal-ablation.html">‘Frontal ablation’</a>).</p></li>
</ul>
<p>For these kinds of attribution, there is nothing we can do automatically. Users need to assign the right values according the actual condition of their glaciers, if the attribution is important to their use cases.</p>
</section>
</section>
<section id="what-s-next">
<h2>What’s next?<a class="headerlink" href="#what-s-next" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>return to the <a class="reference external" href="https://docs.oggm.org">OGGM documentation</a></p></li>
<li><p>back to the <a class="reference internal" href="welcome.html"><span class="doc std std-doc">table of contents</span></a></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="merging_glaciers.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Merging glaciers for past climate simulations</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="massbalance_calibration.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">A quick look into different mass-balance calibration options</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By OGGM e.V. and OGGM Contributors<br/>
  
    <div class="extra_footer">
      <p>
These notebooks are licensed under a <a href="https://github.com/OGGM/tutorials/blob/master/LICENSE.txt" target="_blank">BSD-3-Clause license</a>.
<br>
&copy; Copyright 2014-2021.
</p>

    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>