

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Using your our own glacier inventory with OGGM &#8212; OGGM tutorials</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-106829797-2"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-106829797-2');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/advanced/use_your_own_inventory';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Compute smoother centerlines for shapefile output" href="centerlines_to_shape.html" />
    <link rel="prev" title="Create local topography maps from different DEM sources with OGGM" href="dem_sources.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../welcome.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../welcome.html">
                    Welcome to the OGGM tutorials!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">10 minutes tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../10minutes/preprocessed_directories.html">10 minutes to… a preprocessed directory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10minutes/run_with_gcm.html">10 minutes to… a glacier change projection with GCM data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10minutes/machine_learning.html">10 minutes to… OGGM as an accelerator for modelling and machine learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10minutes/elevation_bands_vs_centerlines.html">10 minutes to… “elevation band” and “centerline” flowlines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10minutes/dynamical_spinup.html">10 minutes to… understand the new dynamical spinup in OGGM v1.6</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10minutes/numeric_solvers.html">10 minutes to… understand difference between ice dynamic models</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Beginner tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../beginner/working_with_rgi.html">Working with the RGI files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/store_and_compress_glacierdirs.html">Storing glacier directories for later use</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/plot_mass_balance.html">Plotting the OGGM surface mass-balance, the ELA and AAR</a></li>

<li class="toctree-l1"><a class="reference internal" href="../beginner/distribute_flowline.html">Compute area and thickness changes on a grid (nice, but experimental!)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/deal_with_errors.html">Dealing with errors after a run</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/inversion.html">Ice thickness inversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/hydrological_output.html">Hydrological mass-balance output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/oggm_shop.html">OGGM-Shop and Glacier Directories in OGGM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/full_prepro_workflow.html">What’s in my preprocessed directories with centerlines? A full OGGM workflow, step by step</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced tutorials</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="preprocessing_errors.html">Error analysis of the global pre-processing workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="run_with_a_spinup_and_gcm_data.html">Run with a spinup and GCM data</a></li>
<li class="toctree-l1"><a class="reference internal" href="dem_sources.html">Create local topography maps from different DEM sources with OGGM</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Using your our own glacier inventory with OGGM</a></li>
<li class="toctree-l1"><a class="reference internal" href="centerlines_to_shape.html">Compute smoother centerlines for shapefile output</a></li>
<li class="toctree-l1"><a class="reference internal" href="massbalance_calibration.html">A look into the new mass balance calibration in OGGM v1.6</a></li>
<li class="toctree-l1"><a class="reference internal" href="where_are_the_flowlines.html">OGGM flowlines: where are they?</a></li>
<li class="toctree-l1"><a class="reference internal" href="ingest_gridded_data_on_flowlines.html">Ingest gridded products such as ice velocity into OGGM</a></li>
<li class="toctree-l1"><a class="reference internal" href="merge_gcm_runs_and_visualize.html">Merge, analyse and visualize OGGM GCM runs</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamical_spinup.html">Dynamic spinup and dynamic <em>melt_f</em> calibration for past simulations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">RGI-TOPO</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../others/rgitopo_rgi6.html">Compare different DEMs for individual glaciers: RGI-TOPO for RGI v6.0https://cluster.klima.uni-bremen.de/data/gdirs/dems_v2/default https://cluster.klima.uni-bremen.de/data/gdirs/dems_v2/default https://cluster.klima.uni-bremen.de/data/gdirs/dems_v2/default</a></li>
<li class="toctree-l1"><a class="reference internal" href="../others/rgitopo_rgi7.html">RGI-TOPO for RGI 7.0</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Related to OGGM</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../others/holoviz_intro.html">Small overview of HoloViz capability of data exploration</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">In (re-)construction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../construction/inversion_with_frontal_ablation.html">Ice thickness inversion with frontal ablation: a case study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../construction/kcalving_parameterization.html">The Oerlemans &amp; Nick frontal ablation parameterization in OGGM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../construction/merging_glaciers.html">Merging glaciers for past climate simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../construction/area_length_filter.html">Filter the glacier length and area time series</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/OGGM/tutorials/master?urlpath=lab/tree/./notebooks/advanced/use_your_own_inventory.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://hub.oggm.org/hub/user-redirect/git-pull?repo=https%3A//github.com/OGGM/tutorials&urlpath=lab/tree/tutorials/./notebooks/advanced/use_your_own_inventory.ipynb&branch=master" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/OGGM/tutorials" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/OGGM/tutorials/edit/master/./notebooks/advanced/use_your_own_inventory.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/OGGM/tutorials/issues/new?title=Issue%20on%20page%20%2Fnotebooks/advanced/use_your_own_inventory.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/advanced/use_your_own_inventory.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Using your our own glacier inventory with OGGM</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tldr">TLDR;</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#structure-of-an-rgi-file">Structure of an RGI file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-1-dividing-a-glacier-into-smaller-entities">Case 1: dividing a glacier into smaller entities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-a-new-rgi-file">Make a new “RGI file”</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-intersects">Compute the intersects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finally-the-oggm-run">Finally: the OGGM run</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-2-merging-glaciers">Case 2: merging glaciers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#original-rgi-outlines">Original RGI outlines</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-merge-these-two-outlines-using-geopandas">Let’s merge these two outlines using geopandas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rgi-attributes">RGI attributes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-oggm-with-this-new-glacier">Run OGGM with this new glacier</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-3-start-from-a-completely-independent-inventory">Case 3: start from a completely independent inventory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#note">Note:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-s-next">What’s next?</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="using-your-our-own-glacier-inventory-with-oggm">
<h1>Using your our own glacier inventory with OGGM<a class="headerlink" href="#using-your-our-own-glacier-inventory-with-oggm" title="Permalink to this heading">#</a></h1>
<p><a class="reference external" href="https://www.glims.org/RGI/">The Randolph Glacier Inventory</a> is a key dataset to model glaciers at any scale: it includes outlines of the extent of each glacier in the world, an information that is critical in figuring out how much a particular glacier might contribute to rising sea level. These glacier outlines are the starting point of any simulation in OGGM. The RGI’s latest version (v6), as well as v5, are provided and supported by OGGM (see the <a class="reference external" href="https://oggm.readthedocs.io/en/latest/input-data.html#glacier-outlines-and-intersects">documentation</a>). However, there are <a class="reference external" href="https://rgitools.readthedocs.io/en/latest/known-issues.html">several issues</a> in the RGI that might make you want to use your own corrected glacier outlines.</p>
<p>This notebook describes how to feed OGGM with them. We will show you three case studies about how to give any geometry to OGGM and avoid errors of incompatibility between your shapefile and the model framework.</p>
<p>We have three case studies which should cover a number of applications:</p>
<ol class="arabic simple">
<li><p><span class="xref myst">Dividing a glacier into smaller entities</span> (common case, useful for poorly outlined glaciers, which are in reality separate dynamical entities)</p></li>
<li><p><span class="xref myst">Merging two glaciers together</span> (useful for tidewater glaciers in particular, not much elsewhere)</p></li>
<li><p><span class="xref myst">Start from a completely independent inventory</span></p></li>
</ol>
<section id="tldr">
<h2>TLDR;<a class="headerlink" href="#tldr" title="Permalink to this heading">#</a></h2>
<p>If you want to use custom data to feed OGGM with, you should:</p>
<ul class="simple">
<li><p><strong>make a shapefile that resembles the RGI one: same attributes, and the glacier geometries should be in lon/lat projection</strong>. The most important attribute is <code class="docutils literal notranslate"><span class="pre">geometry</span></code>, of course, but others are used by OGGM as well: refer to <a class="reference external" href="https://docs.oggm.org/en/stable/input-data.html#glacier-outlines-and-intersects">the OGGM documentation</a> to decide which ones. The RGI documentation (found in the RGI directory after download) is useful as well! We also have a useful function (<code class="docutils literal notranslate"><span class="pre">oggm.utils.cook_rgidf</span></code>) which can help you with that.</p></li>
<li><p><strong>compute and use a new <a class="reference external" href="https://rgitools.readthedocs.io/en/latest/tools.html#glacier-intersects">glacier interesects</a> file</strong>, or make sure you don’t need one and disable this option in OGGM.</p></li>
</ul>
</section>
<section id="structure-of-an-rgi-file">
<h2>Structure of an RGI file<a class="headerlink" href="#structure-of-an-rgi-file" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">oggm</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">oggm</span> <span class="kn">import</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">utils</span><span class="p">,</span> <span class="n">workflow</span><span class="p">,</span> <span class="n">tasks</span><span class="p">,</span> <span class="n">graphics</span>
<span class="kn">from</span> <span class="nn">oggm.core</span> <span class="kn">import</span> <span class="n">inversion</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">logging_level</span><span class="o">=</span><span class="s1">&#39;WARNING&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-08-25 13:34:15: oggm.cfg: Reading default parameters from the OGGM `params.cfg` configuration file.
2023-08-25 13:34:15: oggm.cfg: Multiprocessing switched OFF according to the parameter file.
2023-08-25 13:34:15: oggm.cfg: Multiprocessing: using all available processors (N=2)
</pre></div>
</div>
</div>
</div>
<p>Let’s read a file from the standard RGI:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">get_rgi_dir</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="s1">&#39;61&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;/github/home/OGGM/rgi/RGIV61&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sh</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_rgi_region_file</span><span class="p">(</span><span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;61&#39;</span><span class="p">)</span>
<span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;/github/home/OGGM/rgi/RGIV61/11_rgi61_CentralEurope/11_rgi61_CentralEurope.shp&#39;
</pre></div>
</div>
</div>
</div>
<p>Shapefiles are best read an manipulated with <a class="reference external" href="http://geopandas.org/">geopandas</a> in python (see also our <a class="reference internal" href="../beginner/working_with_rgi.html"><span class="doc std std-doc">working_with_rgi</span></a> tutorial):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">sh</span><span class="p">)</span>
<span class="n">gdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RGIId</th>
      <th>GLIMSId</th>
      <th>BgnDate</th>
      <th>EndDate</th>
      <th>CenLon</th>
      <th>CenLat</th>
      <th>O1Region</th>
      <th>O2Region</th>
      <th>Area</th>
      <th>Zmin</th>
      <th>...</th>
      <th>Lmax</th>
      <th>Status</th>
      <th>Connect</th>
      <th>Form</th>
      <th>TermType</th>
      <th>Surging</th>
      <th>Linkages</th>
      <th>Name</th>
      <th>check_geom</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>RGI60-11.00001</td>
      <td>G013599E47495N</td>
      <td>20030799</td>
      <td>20030999</td>
      <td>13.5987</td>
      <td>47.4949</td>
      <td>11</td>
      <td>1</td>
      <td>0.122</td>
      <td>2191</td>
      <td>...</td>
      <td>461</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>POLYGON ((13.60035 47.49330, 13.59995 47.49332...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>RGI60-11.00002</td>
      <td>G013614E47485N</td>
      <td>20030799</td>
      <td>20030999</td>
      <td>13.6135</td>
      <td>47.4845</td>
      <td>11</td>
      <td>1</td>
      <td>2.292</td>
      <td>2203</td>
      <td>...</td>
      <td>1853</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>POLYGON ((13.60638 47.47578, 13.60599 47.47579...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>RGI60-11.00003</td>
      <td>G013596E47484N</td>
      <td>20030799</td>
      <td>20030999</td>
      <td>13.5960</td>
      <td>47.4835</td>
      <td>11</td>
      <td>1</td>
      <td>0.851</td>
      <td>2280</td>
      <td>...</td>
      <td>1140</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>POLYGON ((13.59765 47.47613, 13.59726 47.47614...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>RGI60-11.00004</td>
      <td>G013583E47481N</td>
      <td>20030799</td>
      <td>20030999</td>
      <td>13.5829</td>
      <td>47.4807</td>
      <td>11</td>
      <td>1</td>
      <td>0.053</td>
      <td>2319</td>
      <td>...</td>
      <td>382</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>POLYGON ((13.58283 47.47969, 13.58243 47.47971...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>RGI60-11.00005</td>
      <td>G013603E47477N</td>
      <td>20030799</td>
      <td>20030999</td>
      <td>13.6026</td>
      <td>47.4774</td>
      <td>11</td>
      <td>1</td>
      <td>0.057</td>
      <td>2656</td>
      <td>...</td>
      <td>202</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>POLYGON ((13.60076 47.47519, 13.60036 47.47521...</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div></div></div>
</div>
<p>An RGI file contains the actual glacier geometries, but also a number of attribute which are used by OGGM afterwards. Let’s learn how to make our own file now.</p>
<p><a id='case1'></a></p>
</section>
<section id="case-1-dividing-a-glacier-into-smaller-entities">
<h2>Case 1: dividing a glacier into smaller entities<a class="headerlink" href="#case-1-dividing-a-glacier-into-smaller-entities" title="Permalink to this heading">#</a></h2>
<p>A typical example of wrongly divided glacier is Hintereisferner, in Austria:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># OGGM set-up</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;working_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(</span><span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;rgi-case-1&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;border&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Get the HEF geometry and plot it</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_rgi_glacier_entities</span><span class="p">([</span><span class="s1">&#39;RGI60-11.00897&#39;</span><span class="p">])</span>
<span class="n">gl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-08-25 13:34:46: oggm.cfg: PARAMS[&#39;border&#39;] changed from `80` to `10`.
</pre></div>
</div>
<img alt="../../_images/6a0cd03409d915103c43beeaa0406aa012ea91707234a625478f46e3182e17d6.png" src="../../_images/6a0cd03409d915103c43beeaa0406aa012ea91707234a625478f46e3182e17d6.png" />
</div>
</div>
<p>Obviously, the two smaller tongues used to flow in the main one but this is not the case anymore today. We need updated geometries.</p>
<section id="make-a-new-rgi-file">
<h3>Make a new “RGI file”<a class="headerlink" href="#make-a-new-rgi-file" title="Permalink to this heading">#</a></h3>
<p>There is no simple way to automate the process of finding these bad geometries, but we are <a class="reference external" href="https://github.com/OGGM/partitioning">working on this</a> (don’t hold your breath, this has been in development since a long time). Here we use a geometry that we prepared in QGis:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We simulate the case where we only have the geometry, nothing else</span>
<span class="n">divides</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">get_demo_file</span><span class="p">(</span><span class="s1">&#39;divides_alps.shp&#39;</span><span class="p">))</span>
<span class="n">divides</span> <span class="o">=</span> <span class="n">divides</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">divides</span><span class="o">.</span><span class="n">RGIId</span> <span class="o">==</span> <span class="s1">&#39;RGI50-11.00897&#39;</span><span class="p">][[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]]</span>
<span class="n">divides</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>POLYGON ((10.74505 46.80376, 10.74610 46.80293...</td>
    </tr>
    <tr>
      <th>93</th>
      <td>POLYGON ((10.74860 46.80493, 10.74717 46.80529...</td>
    </tr>
    <tr>
      <th>94</th>
      <td>POLYGON ((10.74602 46.80561, 10.74717 46.80529...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">divides</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/399ec3198a2a478370c6d24fa97d8d42d34235b02179e25d766e83f44eed1310.png" src="../../_images/399ec3198a2a478370c6d24fa97d8d42d34235b02179e25d766e83f44eed1310.png" />
</div>
</div>
<p>Now we use the RGI entity as template - it’s good to use the same attributes as the original RGI glacier, because most of them are already correct:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">gl</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">template</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RGIId</th>
      <th>GLIMSId</th>
      <th>BgnDate</th>
      <th>EndDate</th>
      <th>CenLon</th>
      <th>CenLat</th>
      <th>O1Region</th>
      <th>O2Region</th>
      <th>Area</th>
      <th>Zmin</th>
      <th>...</th>
      <th>Aspect</th>
      <th>Lmax</th>
      <th>Status</th>
      <th>Connect</th>
      <th>Form</th>
      <th>TermType</th>
      <th>Surging</th>
      <th>Linkages</th>
      <th>Name</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>RGI60-11.00897</td>
      <td>G010758E46800N</td>
      <td>20030799</td>
      <td>20030999</td>
      <td>10.7584</td>
      <td>46.8003</td>
      <td>11</td>
      <td>1</td>
      <td>8.036</td>
      <td>2430</td>
      <td>...</td>
      <td>71</td>
      <td>7178</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>1</td>
      <td>Hintereisferner</td>
      <td>POLYGON ((10.75085 46.81381, 10.75112 46.81397...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>RGI60-11.00897</td>
      <td>G010758E46800N</td>
      <td>20030799</td>
      <td>20030999</td>
      <td>10.7584</td>
      <td>46.8003</td>
      <td>11</td>
      <td>1</td>
      <td>8.036</td>
      <td>2430</td>
      <td>...</td>
      <td>71</td>
      <td>7178</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>1</td>
      <td>Hintereisferner</td>
      <td>POLYGON ((10.75085 46.81381, 10.75112 46.81397...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>RGI60-11.00897</td>
      <td>G010758E46800N</td>
      <td>20030799</td>
      <td>20030999</td>
      <td>10.7584</td>
      <td>46.8003</td>
      <td>11</td>
      <td>1</td>
      <td>8.036</td>
      <td>2430</td>
      <td>...</td>
      <td>71</td>
      <td>7178</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>1</td>
      <td>Hintereisferner</td>
      <td>POLYGON ((10.75085 46.81381, 10.75112 46.81397...</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 23 columns</p>
</div></div></div>
</div>
<p>We change the important ones:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Attributes</span>
<span class="n">template</span><span class="p">[</span><span class="s1">&#39;RGIId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;RGI60-11.00897_d01&#39;</span><span class="p">,</span> <span class="s1">&#39;RGI60-11.00897_d02&#39;</span><span class="p">,</span> <span class="s1">&#39;RGI60-11.00897_d03&#39;</span><span class="p">]</span>
<span class="n">template</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Hintereisferner d01&#39;</span><span class="p">,</span> <span class="s1">&#39;Hintereisferner d02&#39;</span><span class="p">,</span> <span class="s1">&#39;Hintereisferner d03&#39;</span><span class="p">]</span>
<span class="c1"># Geometries</span>
<span class="n">template</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">divides</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="c1"># Center point</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">geom</span> <span class="ow">in</span> <span class="n">template</span><span class="p">[[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">cenlon</span><span class="p">,</span> <span class="n">cenlat</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">xy</span>
    <span class="n">template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;CenLon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cenlon</span><span class="p">)</span>
    <span class="n">template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;CenLat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cenlat</span><span class="p">)</span>
<span class="c1"># This is important to properly georeference the file</span>
<span class="kn">import</span> <span class="nn">salem</span>
<span class="n">template</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">salem</span><span class="o">.</span><span class="n">wgs84</span><span class="o">.</span><span class="n">srs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/399ec3198a2a478370c6d24fa97d8d42d34235b02179e25d766e83f44eed1310.png" src="../../_images/399ec3198a2a478370c6d24fa97d8d42d34235b02179e25d766e83f44eed1310.png" />
</div>
</div>
<p>Save it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hef_new_shape_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;working_dir&#39;</span><span class="p">],</span> <span class="s1">&#39;hef_divided.shp&#39;</span><span class="p">)</span>
<span class="n">template</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">hef_new_shape_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-the-intersects">
<h3>Compute the intersects<a class="headerlink" href="#compute-the-intersects" title="Permalink to this heading">#</a></h3>
<p>We would have to install <a class="reference external" href="https://rgitools.readthedocs.io">rgitools</a> first (e.g. <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">git+https://github.com/OGGM/rgitools.git</span></code>)
and also <a class="reference external" href="https://networkx.org/documentation/stable/index.html">networkx</a> (<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">networkx</span></code>) for this to work.</p>
<p>Hintereisferner has a divide with another glacier as well! Let’s find out which:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">intersects_alps</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">get_rgi_intersects_region_file</span><span class="p">(</span><span class="s1">&#39;11&#39;</span><span class="p">))</span>
<span class="n">intersects_hef</span> <span class="o">=</span> <span class="n">intersects_alps</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">intersects_alps</span><span class="o">.</span><span class="n">RGIId_1</span> <span class="o">==</span> <span class="s1">&#39;RGI60-11.00897&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">intersects_alps</span><span class="o">.</span><span class="n">RGIId_2</span> <span class="o">==</span> <span class="s1">&#39;RGI60-11.00897&#39;</span><span class="p">)]</span>
<span class="n">intersects_hef</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RGIId_1</th>
      <th>RGIId_2</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>119</th>
      <td>RGI60-11.00846</td>
      <td>RGI60-11.00897</td>
      <td>LINESTRING (10.74826 46.81077, 10.74840 46.810...</td>
    </tr>
    <tr>
      <th>143</th>
      <td>RGI60-11.00897</td>
      <td>RGI60-11.00846</td>
      <td>LINESTRING (10.72557 46.79781, 10.72557 46.797...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ok, we can now create a file which has all the glaciers we need to compute the relevant intersects (note that we could also use the full standard RGI with just HEF replaced):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">orig</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_rgi_glacier_entities</span><span class="p">([</span><span class="s1">&#39;RGI60-11.00846&#39;</span><span class="p">])</span>
<span class="n">template</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">orig</span><span class="o">.</span><span class="n">crs</span>
<span class="n">for_intersects</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">template</span><span class="p">,</span> <span class="n">orig</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">for_intersects</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/47f8684a064da65197ad24cc30c130c613ae58ea471852ee55805e1528ebee23.png" src="../../_images/47f8684a064da65197ad24cc30c130c613ae58ea471852ee55805e1528ebee23.png" />
</div>
</div>
<p>Good! Let’s use <a class="reference external" href="https://rgitools.readthedocs.io">rgitools</a> to compute the intersects for this new situation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># from rgitools.funcs import compute_intersects</span>
<span class="c1"># new_intersects = compute_intersects(for_intersects)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># f, ax = plt.subplots()</span>
<span class="c1"># for_intersects.plot(ax=ax, edgecolor=&#39;k&#39;);</span>
<span class="c1"># new_intersects.plot(ax=ax, edgecolor=&#39;r&#39;);</span>
</pre></div>
</div>
</div>
</div>
<p>Good! We can store our intersects to use them with OGGM afterwards:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># hef_intersects_path = os.path.join(cfg.PATHS[&#39;working_dir&#39;], &#39;hef_divided_intersects.shp&#39;)</span>
<span class="c1"># new_intersects.to_file(hef_intersects_path)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="finally-the-oggm-run">
<h3>Finally: the OGGM run<a class="headerlink" href="#finally-the-oggm-run" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is important! We tell OGGM to recompute the glacier area for us</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;use_rgi_area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1"># Intersects dont work for now</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;use_intersects&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># This is important for centerlines - if you have them</span>
<span class="c1"># cfg.set_intersects_db(hef_intersects_path)</span>

<span class="c1"># This is to avoid a download in the tutorial, you dont&#39; need do this at home</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;dem_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_demo_file</span><span class="p">(</span><span class="s1">&#39;hef_srtm.tif&#39;</span><span class="p">)</span>

<span class="c1"># This is important again - standard OGGM </span>
<span class="n">rgidf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">hef_new_shape_path</span><span class="p">)</span>
<span class="n">gdirs</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">init_glacier_directories</span><span class="p">(</span><span class="n">rgidf</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-08-25 13:34:56: oggm.cfg: PARAMS[&#39;use_rgi_area&#39;] changed from `True` to `False`.
2023-08-25 13:34:56: oggm.cfg: PARAMS[&#39;use_intersects&#39;] changed from `True` to `False`.
2023-08-25 13:34:56: oggm.workflow: Execute entity tasks [GlacierDirectory] on 3 glaciers
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">workflow</span><span class="o">.</span><span class="n">execute_entity_task</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">define_glacier_region</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">);</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">execute_entity_task</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">glacier_masks</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">);</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">execute_entity_task</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">compute_centerlines</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">);</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">execute_entity_task</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">initialize_flowlines</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">);</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">execute_entity_task</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">catchment_area</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">);</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">execute_entity_task</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">catchment_width_geom</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">);</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">execute_entity_task</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">catchment_width_correction</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-08-25 13:34:57: oggm.workflow: Execute entity tasks [define_glacier_region] on 3 glaciers
2023-08-25 13:34:59: oggm.workflow: Execute entity tasks [glacier_masks] on 3 glaciers
2023-08-25 13:35:00: oggm.workflow: Execute entity tasks [compute_centerlines] on 3 glaciers
2023-08-25 13:35:00: oggm.workflow: Execute entity tasks [initialize_flowlines] on 3 glaciers
2023-08-25 13:35:00: oggm.workflow: Execute entity tasks [catchment_area] on 3 glaciers
2023-08-25 13:35:02: oggm.workflow: Execute entity tasks [catchment_width_geom] on 3 glaciers
2023-08-25 13:35:03: oggm.workflow: Execute entity tasks [catchment_width_correction] on 3 glaciers
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_catchment_width</span><span class="p">(</span><span class="n">gdirs</span><span class="p">,</span> <span class="n">add_intersects</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">corrected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/368240d0121fab8f6e110fe3c80be32b7a70a3c432bbb351b41f2b6603ca99ea.png" src="../../_images/368240d0121fab8f6e110fe3c80be32b7a70a3c432bbb351b41f2b6603ca99ea.png" />
</div>
</div>
<p>It works!</p>
<p><strong>The intersects in OGGM are used for two main things:</strong></p>
<ul class="simple">
<li><p>when a grid-point glacier section touches an intersect, it will be attributed a rectangular bed (instead of a parabolic one)</p></li>
<li><p>when interpolating the ice thickness to a 2D grid, the boundary condition thickness=0 at the glacier outline is removed where there are intersects</p></li>
</ul>
<p><strong>We recommend to use intersects for your runs as well, IF YOU ARE USING CENTERLINES. For elevation bands, intersects are ignored.</strong></p>
<p><a id='case2'></a></p>
</section>
</section>
<section id="case-2-merging-glaciers">
<h2>Case 2: merging glaciers<a class="headerlink" href="#case-2-merging-glaciers" title="Permalink to this heading">#</a></h2>
<p>Sometimes, you may want to <em>merge</em> glaciers together. This case is less frequent than Case 1, but might be useful for calving glaciers, which are sometimes divided in the RGI.</p>
<section id="original-rgi-outlines">
<h3>Original RGI outlines<a class="headerlink" href="#original-rgi-outlines" title="Permalink to this heading">#</a></h3>
<p>We use a case study for two marine-terminating glaciers in Alaska that have to be merged into a single outline in order to model a correct calving flux for these glaciers (following the methods described in
<a class="reference external" href="https://www.the-cryosphere.net/13/2657/2019/tc-13-2657-2019.html">Recinos et al., (2019)</a>). The resulting shapefile is a new one that needs to be adapted in order for OGGM to run.</p>
<p>We will study the Sawyer Glacier (<code class="docutils literal notranslate"><span class="pre">RGI60-01.03890</span></code>) that is actually connected via the calving front with this other entity (<code class="docutils literal notranslate"><span class="pre">RGI60-01.23664</span></code>). Visit this <a class="reference external" href="https://glacierchange.wordpress.com/2011/03/16/saywer-glacier-alaska-retreat/">link</a> to learn more about the retreat of the Sawyer Glacier and see images illustrating this connection.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gl</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_rgi_glacier_entities</span><span class="p">([</span><span class="s1">&#39;RGI60-01.03890&#39;</span><span class="p">,</span> <span class="s1">&#39;RGI60-01.23664&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Here OGGM downloaded the outlines for both glaciers. If we plot them together, we can see that both glaciers drain into the same fjord. See the google map below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cfg</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">logging_level</span><span class="o">=</span><span class="s1">&#39;WARNING&#39;</span><span class="p">)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;working_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(</span><span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;rgi-case-2-example&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;border&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">base_url</span> <span class="o">=</span> <span class="s1">&#39;https://cluster.klima.uni-bremen.de/~oggm/gdirs/oggm_v1.6/L3-L5_files/2023.1/elev_bands/W5E5/&#39;</span>
<span class="n">gdirs</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">init_glacier_directories</span><span class="p">([</span><span class="s1">&#39;RGI60-01.03890&#39;</span><span class="p">,</span> <span class="s1">&#39;RGI60-01.23664&#39;</span><span class="p">],</span> <span class="n">from_prepro_level</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">prepro_base_url</span><span class="o">=</span><span class="n">base_url</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">graphics</span><span class="o">.</span><span class="n">plot_googlemap</span><span class="p">(</span><span class="n">gdirs</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-08-25 13:35:25: oggm.cfg: Reading default parameters from the OGGM `params.cfg` configuration file.
2023-08-25 13:35:25: oggm.cfg: Multiprocessing switched OFF according to the parameter file.
2023-08-25 13:35:25: oggm.cfg: Multiprocessing: using all available processors (N=2)
2023-08-25 13:35:25: oggm.cfg: PARAMS[&#39;border&#39;] changed from `80` to `10`.
2023-08-25 13:35:25: oggm.workflow: init_glacier_directories from prepro level 3 on 2 glaciers.
2023-08-25 13:35:25: oggm.workflow: Execute entity tasks [gdir_from_prepro] on 2 glaciers
</pre></div>
</div>
<img alt="../../_images/7374af31029b43dc17ac83d7e3f0ee0b3442d845d0749e9ac38ef6a67cdf08b4.png" src="../../_images/7374af31029b43dc17ac83d7e3f0ee0b3442d845d0749e9ac38ef6a67cdf08b4.png" />
</div>
</div>
<p>The upper glacier map is a zoom version of the plot below.
They share the same glaciers terminus. Therefore, to estimate a calving flux for these glaciers we need them connected.</p>
</section>
<section id="let-s-merge-these-two-outlines-using-geopandas">
<h3>Let’s merge these two outlines using geopandas<a class="headerlink" href="#let-s-merge-these-two-outlines-using-geopandas" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">dissolve</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;O2Region&#39;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
<span class="n">merged</span> <span class="o">=</span> <span class="n">merged</span><span class="p">[</span><span class="n">gl</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="n">merged</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ddb57a3e4cd1e5ec51655c9f7688e7b2b79ca8ccfa95b92e2b0dfc15e18e9588.png" src="../../_images/ddb57a3e4cd1e5ec51655c9f7688e7b2b79ca8ccfa95b92e2b0dfc15e18e9588.png" />
</div>
</div>
</section>
<section id="rgi-attributes">
<h3>RGI attributes<a class="headerlink" href="#rgi-attributes" title="Permalink to this heading">#</a></h3>
<p>We now have a new shapefile, which resembles an RGI one but has wrong attributes. Some aren’t relevant, but some are. See the <a class="reference external" href="https://oggm.readthedocs.io/en/latest/input-data.html#glacier-outlines-and-intersects">documentation</a> for a list.</p>
<p>The important ones are: RGIId, CenLon, CenLat, TermType, Area. Area and CenLon, Cenlat can be calculated by OGGM later, as we have seen earlier. Here, we prefer to keep the Area computed by the RGI for consistency.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We use the RGI as template (this avoids strange IO issues)</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">template</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change CenLon, CenLat</span>
<span class="n">cenlon</span><span class="p">,</span> <span class="n">cenlat</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">representative_point</span><span class="p">()</span><span class="o">.</span><span class="n">xy</span>
<span class="n">template</span><span class="p">[</span><span class="s1">&#39;CenLon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cenlon</span>
<span class="n">template</span><span class="p">[</span><span class="s1">&#39;CenLat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cenlat</span>

<span class="c1"># We sum up the areas</span>
<span class="n">template</span><span class="p">[</span><span class="s1">&#39;Area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">Area</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">template</span><span class="p">[</span><span class="s1">&#39;Area&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3889    275.739
Name: Area, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>In <a class="reference external" href="https://www.the-cryosphere.net/13/2657/2019/tc-13-2657-2019.html">Recinos et al., (2019)</a> we wanted to estimate a frontal ablation flux for this new outline and compare it with previous estimates found in the literature for the Sawyer Glacier (<a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1002/2014JF003276">McNabb et al., 2015</a>).</p>
<p>For this reason we kept the Sawyer glacier attributes to the following variables:
<code class="docutils literal notranslate"><span class="pre">RGIId,</span> <span class="pre">GLIMSId,</span> <span class="pre">Name</span></code></p>
<p>The <code class="docutils literal notranslate"><span class="pre">TermType</span></code> should be equal to 1, for Marine-terminating.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="p">[</span><span class="s1">&#39;TermType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">template</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Sawyer Glacier merged with RGI60-01.23664&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can write a new shapefile for this glacier.
We recommend doing this if you have to make several model runs. You can also integrate this outline to your main RGI shapefile:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cfg</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;working_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(</span><span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;rgi-case-2&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">template</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">salem</span><span class="o">.</span><span class="n">wgs84</span><span class="o">.</span><span class="n">srs</span>
<span class="n">template</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;working_dir&#39;</span><span class="p">],</span> <span class="s1">&#39;merged.shp&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-08-25 13:35:38: oggm.cfg: Reading default parameters from the OGGM `params.cfg` configuration file.
2023-08-25 13:35:38: oggm.cfg: Multiprocessing switched OFF according to the parameter file.
2023-08-25 13:35:38: oggm.cfg: Multiprocessing: using all available processors (N=2)
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-oggm-with-this-new-glacier">
<h3>Run OGGM with this new glacier<a class="headerlink" href="#run-oggm-with-this-new-glacier" title="Permalink to this heading">#</a></h3>
<p>For simplicity, we do not compute the intersects in this case: <strong>however, we recommend you do do so (see above). In all cases, do not use the intersects provided automatically with OGGM when using custom inventories, as they are likely to be wrong.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set-up the run</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;border&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># We don&#39;t use intersects here</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;use_intersects&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># We prefer OGGM to use the area we computed ourselves</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;use_rgi_area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># Use our merged file</span>
<span class="n">rgidf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;working_dir&#39;</span><span class="p">],</span> <span class="s1">&#39;merged.shp&#39;</span><span class="p">))</span>
<span class="n">gdirs</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">init_glacier_directories</span><span class="p">(</span><span class="n">rgidf</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gdirs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-08-25 13:35:38: oggm.cfg: PARAMS[&#39;border&#39;] changed from `80` to `10`.
2023-08-25 13:35:38: oggm.cfg: PARAMS[&#39;use_intersects&#39;] changed from `True` to `False`.
2023-08-25 13:35:38: oggm.workflow: Execute entity tasks [GlacierDirectory] on 1 glaciers
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;oggm.GlacierDirectory&gt;
   RGI id: RGI60-01.03890
   Region: 01: Alaska
   Subregion: 01-06: N Coast Ranges                  
   Name: Sawyer Glacier Merged With Rgi60-01.23664
   Glacier type: Glacier
   Terminus type: Marine-terminating
   Status: Glacier or ice cap
   Area: 275.739 km2
   Lon, Lat: (-133.00381863880597, 57.939250464000054)]
</pre></div>
</div>
</div>
</div>
<p>Here we are not able to use the <a class="reference external" href="https://docs.oggm.org/en/stable/input-data.html#pre-processed-directories">Pre-processed directories</a> and the respective <a class="reference external" href="https://docs.oggm.org/en/stable/input-data.html#preprodir">Processing levels</a> that OGGM provides for a easy run set up. We can’t use this workflow simply because we have a different beginning than OGGM, we have a different RGI! We just need to type more and run all the model task one by one:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">oggm.workflow</span> <span class="kn">import</span> <span class="n">execute_entity_task</span>

<span class="c1"># Calculate the DEMs and the masks</span>
<span class="n">execute_entity_task</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">define_glacier_region</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">,</span> <span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;SRTM&#39;</span><span class="p">)</span>
<span class="n">execute_entity_task</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">glacier_masks</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">)</span>

<span class="c1"># Calculate the Pre-processing tasks</span>
<span class="n">task_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">tasks</span><span class="o">.</span><span class="n">compute_centerlines</span><span class="p">,</span>
    <span class="n">tasks</span><span class="o">.</span><span class="n">initialize_flowlines</span><span class="p">,</span>
    <span class="n">tasks</span><span class="o">.</span><span class="n">catchment_area</span><span class="p">,</span>
    <span class="n">tasks</span><span class="o">.</span><span class="n">catchment_width_geom</span><span class="p">,</span>
    <span class="n">tasks</span><span class="o">.</span><span class="n">catchment_width_correction</span><span class="p">,</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">task_list</span><span class="p">:</span>
    <span class="n">execute_entity_task</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-08-25 13:35:39: oggm.workflow: Execute entity tasks [define_glacier_region] on 1 glaciers
2023-08-25 13:35:39: oggm.core.gis: (RGI60-01.03890) define_glacier_region
2023-08-25 13:35:39: oggm.utils: Downloading http://srtm.csi.cgiar.org/wp-content/uploads/files/srtm_5x5/TIFF/srtm_10_01.zip to /github/home/OGGM/download_cache/srtm.csi.cgiar.org/wp-content/uploads/files/srtm_5x5/TIFF/srtm_10_01.zip...
2023-08-25 13:35:43: oggm.workflow: Execute entity tasks [glacier_masks] on 1 glaciers
2023-08-25 13:35:43: oggm.core.gis: (RGI60-01.03890) glacier_masks
2023-08-25 13:35:43: oggm.core.gis: (RGI60-01.03890) process_dem
2023-08-25 13:35:44: oggm.core.gis: RGI60-01.03890: DEM needed interpolation.
2023-08-25 13:35:45: oggm.workflow: Execute entity tasks [compute_centerlines] on 1 glaciers
2023-08-25 13:35:45: oggm.core.centerlines: (RGI60-01.03890) compute_centerlines
2023-08-25 13:35:45: oggm.workflow: Execute entity tasks [initialize_flowlines] on 1 glaciers
2023-08-25 13:35:45: oggm.core.centerlines: (RGI60-01.03890) initialize_flowlines
2023-08-25 13:35:45: oggm.workflow: Execute entity tasks [catchment_area] on 1 glaciers
2023-08-25 13:35:45: oggm.core.centerlines: (RGI60-01.03890) catchment_area
2023-08-25 13:35:51: oggm.workflow: Execute entity tasks [catchment_width_geom] on 1 glaciers
2023-08-25 13:35:51: oggm.core.centerlines: (RGI60-01.03890) catchment_width_geom
2023-08-25 13:35:52: oggm.workflow: Execute entity tasks [catchment_width_correction] on 1 glaciers
2023-08-25 13:35:52: oggm.core.centerlines: (RGI60-01.03890) catchment_width_correction
</pre></div>
</div>
</div>
</div>
<p>note that we used in <code class="docutils literal notranslate"><span class="pre">tasks.define_glacier_region</span></code> SRTM as DEM source which is not the default one in OGGM.
The default one is NASADEM, but for that you have to register at <a class="reference external" href="https://urs.earthdata.nasa.gov/">NASA Earthdata</a>
more info in <span class="xref myst">dem_sources.ipynb/register</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_googlemap</span><span class="p">(</span><span class="n">gdirs</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0539ac710d74c49503b653f3d0ffda554ec8ddfc0c9e0aeeaee555f5eda223da.png" src="../../_images/0539ac710d74c49503b653f3d0ffda554ec8ddfc0c9e0aeeaee555f5eda223da.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_catchment_width</span><span class="p">(</span><span class="n">gdirs</span><span class="p">,</span> <span class="n">corrected</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d97316eb406eeb4719e4ec0bbbc338e721c6edfc94877d083dad3e01214578e6.png" src="../../_images/d97316eb406eeb4719e4ec0bbbc338e721c6edfc94877d083dad3e01214578e6.png" />
</div>
</div>
<p><a id='case3'></a></p>
</section>
</section>
<section id="case-3-start-from-a-completely-independent-inventory">
<h2>Case 3: start from a completely independent inventory<a class="headerlink" href="#case-3-start-from-a-completely-independent-inventory" title="Permalink to this heading">#</a></h2>
<p>OGGM (since version 1.5.3) now offers a function (<code class="docutils literal notranslate"><span class="pre">utils.cook_rgidf()</span></code>) to make it easier of using a non-RGI glacier inventory in OGGM. Now, let’s use a non-RGI glacier inventory from the second Chinese glacier inventory (CGI2, <a class="reference external" href="https://doi.org/10.3189/2015JoG14J209">https://doi.org/10.3189/2015JoG14J209</a>) to show how it works.</p>
<p><strong>New in OGGM 1.6.1</strong>: If you using outlines consisting of multi polygons and plan to use “elevation band” flowlines (see <a class="reference internal" href="../10minutes/elevation_bands_vs_centerlines.html"><span class="doc std std-doc">10 minutes to… “elevation band” and “centerline” flowlines</span></a>) you can keep the complete multi polygon area for your simulations by setting <code class="docutils literal notranslate"><span class="pre">cfg.PARAMS['keep_multipolygon_outlines']</span> <span class="pre">=</span> <span class="pre">True</span></code>. That can be useful when working with local glacier inventories with multiple outlines (e.g. older outline single polygon but newer outline multi polygon for the same glacier).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s get the sample CGI2 glacier inventory and see what it looks like</span>
<span class="kn">from</span> <span class="nn">oggm</span> <span class="kn">import</span> <span class="n">utils</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="n">cgidf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">get_demo_file</span><span class="p">(</span><span class="s1">&#39;cgi2.shp&#39;</span><span class="p">))</span>
<span class="n">cgidf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Glc_Name</th>
      <th>Drng_Code</th>
      <th>FCGI_ID</th>
      <th>GLIMS_ID</th>
      <th>Mtn_Name</th>
      <th>Pref_Name</th>
      <th>Glc_Long</th>
      <th>Glc_Lati</th>
      <th>Glc_Area</th>
      <th>Abs_Accu</th>
      <th>...</th>
      <th>Mean_Slp</th>
      <th>Mean_Asp</th>
      <th>Prm_Image</th>
      <th>Aux_Image</th>
      <th>Rep_Date</th>
      <th>Elev_Src</th>
      <th>Elev_Date</th>
      <th>Compiler</th>
      <th>Verifier</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>5X043P</td>
      <td>5X043P0038</td>
      <td>G084892E43502N</td>
      <td>天山</td>
      <td>新疆维吾尔自治区伊犁哈萨克自治州</td>
      <td>84.892252</td>
      <td>43.502473</td>
      <td>4410738.3</td>
      <td>154881.40</td>
      <td>...</td>
      <td>15.1</td>
      <td>247.5</td>
      <td>Landsat:P144R030,TM,2009-08-08</td>
      <td>NaN</td>
      <td>2009年8月8日</td>
      <td>SRTM V4</td>
      <td>Feb, 2000</td>
      <td>李萍</td>
      <td>魏俊锋</td>
      <td>POLYGON ((-1597545.625 4858570.500, -1597500.1...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>5Y533B</td>
      <td>5Y533B0022</td>
      <td>G094299E35672N</td>
      <td>昆仑山</td>
      <td>青海省海西蒙古族藏族自治州</td>
      <td>94.299430</td>
      <td>35.671728</td>
      <td>2569748.4</td>
      <td>80390.42</td>
      <td>...</td>
      <td>25.6</td>
      <td>27.3</td>
      <td>Landsat:P136R035,TM,2006-07-23</td>
      <td>Landsat:P136R035,TM,2010-04-29;P136R035,ETM+,2...</td>
      <td>2006年7月23日</td>
      <td>SRTM V4</td>
      <td>Feb, 2000</td>
      <td>李萍</td>
      <td>郭万钦</td>
      <td>POLYGON ((-950552.062 3862119.750, -950515.125...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>5O282A</td>
      <td>5O282A0750</td>
      <td>G096290E29880N</td>
      <td>念青唐古拉山</td>
      <td>西藏自治区林芝地区</td>
      <td>96.289832</td>
      <td>29.879834</td>
      <td>320096.7</td>
      <td>33721.87</td>
      <td>...</td>
      <td>27.2</td>
      <td>96.5</td>
      <td>Landsat:P134R039,TM,2005-09-08</td>
      <td>NaN</td>
      <td>2005年9月8日</td>
      <td>SRTM V4</td>
      <td>Feb, 2000</td>
      <td>李萍</td>
      <td>李刚</td>
      <td>POLYGON ((-830689.750 3194922.500, -830685.250...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>5K441M</td>
      <td>5K441M0100</td>
      <td>G092234E32782N</td>
      <td>唐古拉山</td>
      <td>青海省海西蒙古族藏族自治州</td>
      <td>92.234420</td>
      <td>32.781958</td>
      <td>969356.4</td>
      <td>43823.40</td>
      <td>...</td>
      <td>15.2</td>
      <td>101.3</td>
      <td>Landsat:P137R037,TM,2007-09-19</td>
      <td>NaN</td>
      <td>2007年9月19日</td>
      <td>SRTM V4</td>
      <td>Feb, 2000</td>
      <td>李萍</td>
      <td>盖春梅</td>
      <td>POLYGON ((-1173462.875 3559676.750, -1173507.2...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>5O291B</td>
      <td>5O291B0528</td>
      <td>G097340E29195N</td>
      <td>横断山</td>
      <td>西藏自治区林芝地区</td>
      <td>97.340135</td>
      <td>29.195439</td>
      <td>839757.2</td>
      <td>47341.39</td>
      <td>...</td>
      <td>14.3</td>
      <td>329.4</td>
      <td>Landsat:P134R040,TM,2005-09-08</td>
      <td>NaN</td>
      <td>2005年9月8日</td>
      <td>SRTM V4</td>
      <td>Feb, 2000</td>
      <td>李萍</td>
      <td>李刚</td>
      <td>POLYGON ((-735850.625 3109206.750, -735851.312...</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 30 columns</p>
</div></div></div>
</div>
<p>Ha! There are some Chinese characters! But it should not influence our work. Now, let’s try with the simplest case:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rgidf_simple</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">cook_rgidf</span><span class="p">(</span><span class="n">cgidf</span><span class="p">,</span> <span class="n">o1_region</span><span class="o">=</span><span class="s1">&#39;13&#39;</span><span class="p">)</span>
<span class="n">rgidf_simple</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RGIId</th>
      <th>CenLon</th>
      <th>CenLat</th>
      <th>GLIMSId</th>
      <th>BgnDate</th>
      <th>EndDate</th>
      <th>O1Region</th>
      <th>O2Region</th>
      <th>Area</th>
      <th>Zmin</th>
      <th>...</th>
      <th>Lmax</th>
      <th>Status</th>
      <th>Connect</th>
      <th>Form</th>
      <th>TermType</th>
      <th>Surging</th>
      <th>Linkages</th>
      <th>check_geom</th>
      <th>Name</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>RGI60-13.00001</td>
      <td>84.897508</td>
      <td>43.504834</td>
      <td></td>
      <td>20009999</td>
      <td>9999999</td>
      <td>13</td>
      <td>01</td>
      <td>-9999.0</td>
      <td>-9999.0</td>
      <td>...</td>
      <td>-9999</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>None</td>
      <td></td>
      <td>POLYGON ((84.88765 43.51793, 84.88820 43.51803...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>RGI60-13.00002</td>
      <td>94.301049</td>
      <td>35.673427</td>
      <td></td>
      <td>20009999</td>
      <td>9999999</td>
      <td>13</td>
      <td>01</td>
      <td>-9999.0</td>
      <td>-9999.0</td>
      <td>...</td>
      <td>-9999</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>None</td>
      <td></td>
      <td>POLYGON ((94.28628 35.67243, 94.28669 35.67247...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>RGI60-13.00003</td>
      <td>96.293274</td>
      <td>29.880223</td>
      <td></td>
      <td>20009999</td>
      <td>9999999</td>
      <td>13</td>
      <td>01</td>
      <td>-9999.0</td>
      <td>-9999.0</td>
      <td>...</td>
      <td>-9999</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>None</td>
      <td></td>
      <td>POLYGON ((96.28739 29.88241, 96.28744 29.88235...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>RGI60-13.00004</td>
      <td>92.233827</td>
      <td>32.781994</td>
      <td></td>
      <td>20009999</td>
      <td>9999999</td>
      <td>13</td>
      <td>01</td>
      <td>-9999.0</td>
      <td>-9999.0</td>
      <td>...</td>
      <td>-9999</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>None</td>
      <td></td>
      <td>POLYGON ((92.23549 32.77855, 92.23501 32.77851...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>RGI60-13.00005</td>
      <td>97.340065</td>
      <td>29.196493</td>
      <td></td>
      <td>20009999</td>
      <td>9999999</td>
      <td>13</td>
      <td>01</td>
      <td>-9999.0</td>
      <td>-9999.0</td>
      <td>...</td>
      <td>-9999</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>None</td>
      <td></td>
      <td>POLYGON ((97.34704 29.18993, 97.34703 29.18993...</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div></div></div>
</div>
<p>In this case, we fake all of the columns values except for <code class="docutils literal notranslate"><span class="pre">geometry</span></code>. With this <code class="docutils literal notranslate"><span class="pre">rgidf_simple</span></code>, we can handle most of the OGGM procedure after set <code class="docutils literal notranslate"><span class="pre">cfg.PARAMS['use_rgi_area']</span> <span class="pre">=</span> <span class="pre">False</span></code>. Let’s have a try:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">oggm</span> <span class="kn">import</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">workflow</span>

<span class="n">cfg</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;use_multiprocessing&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;use_rgi_area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;use_intersects&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;working_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(</span><span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;cook_rgidf&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gdirs</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">init_glacier_directories</span><span class="p">(</span><span class="n">rgidf_simple</span><span class="p">)</span>

<span class="c1"># The tasks below require downloading new data - we comment them for the tutorial, but it should work for you!</span>
<span class="c1"># workflow.gis_prepro_tasks(gdirs)</span>
<span class="c1"># workflow.download_ref_tstars(&#39;https://cluster.klima.uni-bremen.de/~oggm/ref_mb_params/oggm_v1.4/RGIV62/CRU/centerlines/qc3/pcp2.5&#39;)</span>
<span class="c1"># workflow.climate_tasks(gdirs)</span>
<span class="c1"># workflow.inversion_tasks(gdirs)</span>

<span class="n">utils</span><span class="o">.</span><span class="n">compile_glacier_statistics</span><span class="p">(</span><span class="n">gdirs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-08-25 13:35:59: oggm.cfg: Reading default parameters from the OGGM `params.cfg` configuration file.
2023-08-25 13:35:59: oggm.cfg: Multiprocessing switched OFF according to the parameter file.
2023-08-25 13:35:59: oggm.cfg: Multiprocessing: using all available processors (N=2)
2023-08-25 13:35:59: oggm.cfg: Multiprocessing switched ON after user settings.
2023-08-25 13:35:59: oggm.cfg: PARAMS[&#39;use_rgi_area&#39;] changed from `True` to `False`.
2023-08-25 13:35:59: oggm.cfg: PARAMS[&#39;use_intersects&#39;] changed from `True` to `False`.
2023-08-25 13:35:59: oggm.workflow: Execute entity tasks [GlacierDirectory] on 5 glaciers
2023-08-25 13:35:59: oggm.utils: Applying global task compile_glacier_statistics on 5 glaciers
2023-08-25 13:35:59: oggm.workflow: Execute entity tasks [glacier_statistics] on 5 glaciers
2023-08-25 13:35:59: oggm.utils: (RGI60-13.00001) glacier_statistics
2023-08-25 13:35:59: oggm.utils: (RGI60-13.00002) glacier_statistics
2023-08-25 13:36:00: oggm.utils: (RGI60-13.00003) glacier_statistics
2023-08-25 13:36:00: oggm.utils: (RGI60-13.00004) glacier_statistics
2023-08-25 13:36:01: oggm.utils: (RGI60-13.00005) glacier_statistics
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rgi_region</th>
      <th>rgi_subregion</th>
      <th>name</th>
      <th>cenlon</th>
      <th>cenlat</th>
      <th>rgi_area_km2</th>
      <th>rgi_year</th>
      <th>glacier_type</th>
      <th>terminus_type</th>
      <th>is_tidewater</th>
      <th>status</th>
      <th>geometry_type</th>
      <th>geometry_is_valid</th>
      <th>geometry_area_km2</th>
      <th>error_task</th>
      <th>error_msg</th>
    </tr>
    <tr>
      <th>rgi_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>RGI60-13.00001</th>
      <td>13</td>
      <td>13-01</td>
      <td></td>
      <td>84.897508</td>
      <td>43.504834</td>
      <td>4.407211</td>
      <td>2000</td>
      <td>Glacier</td>
      <td>Land-terminating</td>
      <td>False</td>
      <td>Glacier or ice cap</td>
      <td>Polygon</td>
      <td>True</td>
      <td>4.410738</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>RGI60-13.00002</th>
      <td>13</td>
      <td>13-01</td>
      <td></td>
      <td>94.301049</td>
      <td>35.673427</td>
      <td>2.567693</td>
      <td>2000</td>
      <td>Glacier</td>
      <td>Land-terminating</td>
      <td>False</td>
      <td>Glacier or ice cap</td>
      <td>Polygon</td>
      <td>True</td>
      <td>2.569750</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>RGI60-13.00003</th>
      <td>13</td>
      <td>13-01</td>
      <td></td>
      <td>96.293274</td>
      <td>29.880223</td>
      <td>0.319841</td>
      <td>2000</td>
      <td>Glacier</td>
      <td>Land-terminating</td>
      <td>False</td>
      <td>Glacier or ice cap</td>
      <td>Polygon</td>
      <td>True</td>
      <td>0.320097</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>RGI60-13.00004</th>
      <td>13</td>
      <td>13-01</td>
      <td></td>
      <td>92.233827</td>
      <td>32.781994</td>
      <td>0.968581</td>
      <td>2000</td>
      <td>Glacier</td>
      <td>Land-terminating</td>
      <td>False</td>
      <td>Glacier or ice cap</td>
      <td>Polygon</td>
      <td>True</td>
      <td>0.969356</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>RGI60-13.00005</th>
      <td>13</td>
      <td>13-01</td>
      <td></td>
      <td>97.340065</td>
      <td>29.196493</td>
      <td>0.839086</td>
      <td>2000</td>
      <td>Glacier</td>
      <td>Land-terminating</td>
      <td>False</td>
      <td>Glacier or ice cap</td>
      <td>Polygon</td>
      <td>True</td>
      <td>0.839757</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Sometimes, the information in the original glacier inventory also covered what RGI need, but with different name. For example, both CGI2 and RGI include Lon-lat coordinate to indicate the location of the glacier but with different names. CGI2 used <code class="docutils literal notranslate"><span class="pre">Glc_Long</span></code> and <code class="docutils literal notranslate"><span class="pre">Glc_Lati</span></code>, while RGI6 used <code class="docutils literal notranslate"><span class="pre">CenLon</span></code> and <code class="docutils literal notranslate"><span class="pre">CenLat</span></code>. Also, CGI2 include glacier area information with name <code class="docutils literal notranslate"><span class="pre">Glc_Area</span></code>, while RGI named glacier area as <code class="docutils literal notranslate"><span class="pre">Area</span></code>. If we want to keep those values but rename them following RGI, we can use the <code class="docutils literal notranslate"><span class="pre">assign_column_values</span></code> keyword argument:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rgidf_save_columns</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">cook_rgidf</span><span class="p">(</span><span class="n">cgidf</span><span class="p">,</span> <span class="n">o1_region</span><span class="o">=</span><span class="s1">&#39;13&#39;</span><span class="p">,</span> <span class="n">assign_column_values</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Glc_Long&#39;</span><span class="p">:</span> <span class="s1">&#39;CenLon&#39;</span><span class="p">,</span> <span class="s1">&#39;Glc_Lati&#39;</span><span class="p">:</span> <span class="s1">&#39;CenLat&#39;</span><span class="p">,</span> <span class="s1">&#39;Glc_Area&#39;</span><span class="p">:</span> <span class="s1">&#39;Area&#39;</span><span class="p">,</span> <span class="s1">&#39;GLIMS_ID&#39;</span><span class="p">:</span> <span class="s1">&#39;GLIMSId&#39;</span><span class="p">})</span>
<span class="n">rgidf_save_columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RGIId</th>
      <th>CenLon</th>
      <th>CenLat</th>
      <th>GLIMSId</th>
      <th>BgnDate</th>
      <th>EndDate</th>
      <th>O1Region</th>
      <th>O2Region</th>
      <th>Area</th>
      <th>Zmin</th>
      <th>...</th>
      <th>Lmax</th>
      <th>Status</th>
      <th>Connect</th>
      <th>Form</th>
      <th>TermType</th>
      <th>Surging</th>
      <th>Linkages</th>
      <th>check_geom</th>
      <th>Name</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>RGI60-13.00001</td>
      <td>84.892252</td>
      <td>43.502473</td>
      <td>G084892E43502N</td>
      <td>20009999</td>
      <td>9999999</td>
      <td>13</td>
      <td>01</td>
      <td>4410738.3</td>
      <td>-9999.0</td>
      <td>...</td>
      <td>-9999</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>None</td>
      <td></td>
      <td>POLYGON ((84.88765 43.51793, 84.88820 43.51803...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>RGI60-13.00002</td>
      <td>94.299430</td>
      <td>35.671728</td>
      <td>G094299E35672N</td>
      <td>20009999</td>
      <td>9999999</td>
      <td>13</td>
      <td>01</td>
      <td>2569748.4</td>
      <td>-9999.0</td>
      <td>...</td>
      <td>-9999</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>None</td>
      <td></td>
      <td>POLYGON ((94.28628 35.67243, 94.28669 35.67247...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>RGI60-13.00003</td>
      <td>96.289832</td>
      <td>29.879834</td>
      <td>G096290E29880N</td>
      <td>20009999</td>
      <td>9999999</td>
      <td>13</td>
      <td>01</td>
      <td>320096.7</td>
      <td>-9999.0</td>
      <td>...</td>
      <td>-9999</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>None</td>
      <td></td>
      <td>POLYGON ((96.28739 29.88241, 96.28744 29.88235...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>RGI60-13.00004</td>
      <td>92.234420</td>
      <td>32.781958</td>
      <td>G092234E32782N</td>
      <td>20009999</td>
      <td>9999999</td>
      <td>13</td>
      <td>01</td>
      <td>969356.4</td>
      <td>-9999.0</td>
      <td>...</td>
      <td>-9999</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>None</td>
      <td></td>
      <td>POLYGON ((92.23549 32.77855, 92.23501 32.77851...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>RGI60-13.00005</td>
      <td>97.340135</td>
      <td>29.195439</td>
      <td>G097340E29195N</td>
      <td>20009999</td>
      <td>9999999</td>
      <td>13</td>
      <td>01</td>
      <td>839757.2</td>
      <td>-9999.0</td>
      <td>...</td>
      <td>-9999</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>None</td>
      <td></td>
      <td>POLYGON ((97.34704 29.18993, 97.34703 29.18993...</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div></div></div>
</div>
<p>Seems perfect! However, the glacier area in CGI2 is in <span class="math notranslate nohighlight">\(m^2\)</span>, but it is in <span class="math notranslate nohighlight">\(km^2\)</span> for RGI. So, we need to correct the <code class="docutils literal notranslate"><span class="pre">Area</span></code> values right:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rgidf_save_columns</span><span class="p">[</span><span class="s1">&#39;Area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rgidf_save_columns</span><span class="o">.</span><span class="n">Area</span> <span class="o">*</span> <span class="mf">1e-6</span>
<span class="n">rgidf_save_columns</span><span class="o">.</span><span class="n">Area</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    4.410738
1    2.569748
2    0.320097
3    0.969356
4    0.839757
Name: Area, dtype: float64
</pre></div>
</div>
</div>
</div>
<section id="note">
<h3>Note:<a class="headerlink" href="#note" title="Permalink to this heading">#</a></h3>
<p>Despite that <code class="docutils literal notranslate"><span class="pre">cook_rgidf()</span></code> can handle most of the cases for OGGM, there are some limitations. Here, we try to point out some of cases in which the <code class="docutils literal notranslate"><span class="pre">rgidf</span></code> sourced from <code class="docutils literal notranslate"><span class="pre">cook_rgidf()</span></code> might get you in trouble:</p>
<ul class="simple">
<li><p>in <code class="docutils literal notranslate"><span class="pre">cook_rgidf()</span></code>, we assign the glacier form with ‘0’ (Glacier) for all of the glaciers in the original data. OGGM assigns different parameters for glaciers (form ‘0’) and ice caps (form ‘1’).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">termtype</span></code> was also assign as ‘0’ which means ‘land-terminating’. Here again, OGGM treats ‘Marine-terminating’ glaciers differently (see <a class="reference external" href="https://docs.oggm.org/en/stable/frontal-ablation.html">‘Frontal ablation’</a>).</p></li>
</ul>
<p>For these kinds of attribution, there is nothing we can do automatically. Users need to assign the right values according the actual condition of their glaciers, if the attribution is important to their use cases.</p>
</section>
</section>
<section id="what-s-next">
<h2>What’s next?<a class="headerlink" href="#what-s-next" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>return to the <a class="reference external" href="https://docs.oggm.org">OGGM documentation</a></p></li>
<li><p>back to the <a class="reference internal" href="../welcome.html"><span class="doc std std-doc">table of contents</span></a></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/advanced"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="dem_sources.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Create local topography maps from different DEM sources with OGGM</p>
      </div>
    </a>
    <a class="right-next"
       href="centerlines_to_shape.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Compute smoother centerlines for shapefile output</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tldr">TLDR;</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#structure-of-an-rgi-file">Structure of an RGI file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-1-dividing-a-glacier-into-smaller-entities">Case 1: dividing a glacier into smaller entities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-a-new-rgi-file">Make a new “RGI file”</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-intersects">Compute the intersects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finally-the-oggm-run">Finally: the OGGM run</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-2-merging-glaciers">Case 2: merging glaciers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#original-rgi-outlines">Original RGI outlines</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-merge-these-two-outlines-using-geopandas">Let’s merge these two outlines using geopandas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rgi-attributes">RGI attributes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-oggm-with-this-new-glacier">Run OGGM with this new glacier</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-3-start-from-a-completely-independent-inventory">Case 3: start from a completely independent inventory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#note">Note:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-s-next">What’s next?</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By OGGM e.V. and OGGM Contributors
</p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
These notebooks are licensed under a <a href="https://github.com/OGGM/tutorials/blob/master/LICENSE.txt" target="_blank">BSD-3-Clause license</a>.
<br>
&copy; Copyright 2014-2021.
</p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>