
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Merging glaciers for past climate simulations &#8212; OGGM notebook tutorials</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.da26317cf37e5c4af2fa3e6253912353.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using your our own glacier inventory with OGGM" href="use_your_own_inventory.html" />
    <link rel="prev" title="The Oerlemans &amp; Nick frontal ablation parameterization in OGGM" href="kcalving_parameterization.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">OGGM notebook tutorials</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="welcome.html">
   Welcome to the OGGM tutorials!
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Beginner tutorials
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="getting_started.html">
   Getting started with OGGM: a real case study, step by step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="working_with_rgi.html">
   Working with the RGI files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plot_mass_balance.html">
   Plotting the OGGM surface mass-balance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="area_length_filter.html">
   Filter the glacier length and area time series
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="run_with_gcm.html">
   Run OGGM with GCM data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="deal_with_errors.html">
   Dealing with errors after a run
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inversion.html">
   Ice thickness inversion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="store_and_compress_glacierdirs.html">
   Storing and compressing glacier directories for later use
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="elevation_bands_vs_centerlines.html">
   OGGM centerlines versus elevation-band flowlines: a quick comparison
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Advanced tutorials
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="preprocessing_errors.html">
   Error analysis of the global pre-processing workflow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dem_sources.html">
   Create local topography maps from different DEM sources with OGGM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="thickness_model.html">
   A toy statistical model of ice thickness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inversion_with_frontal_ablation.html">
   Ice thickness inversion with frontal ablation: a case study
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kcalving_parameterization.html">
   The Oerlemans &amp; Nick frontal ablation parameterization in OGGM
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Merging glaciers for past climate simulations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="use_your_own_inventory.html">
   Using your our own glacier inventory with OGGM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="massbalance-calibration.html">
   A quick look into the mass-balance calibration procedure
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="where-are-the-flowlines.html">
   OGGM flowlines: where are they?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="oggm_shop.html">
   OGGM-Shop and Glacier Directories in OGGM
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Others
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="pyviz_intro.html">
   Small overview of PyViz capability of data exploration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dem_comparison.html">
   Compare different DEMs for individual glaciers
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/merging_glaciers.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/OGGM/tutorials"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/OGGM/tutorials/issues/new?title=Issue%20on%20page%20%2Fnotebooks/merging_glaciers.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/OGGM/tutorials/edit/master/./notebooks/merging_glaciers.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/OGGM/binder/master?urlpath=git-pull?repo=https://github.com/OGGM/tutorials%26amp%3Bbranch=master%26amp%3Burlpath=lab/tree/tutorials/./notebooks/merging_glaciers.ipynb%3Fautodecode"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://hub.oggm.org/hub/user-redirect/git-pull?repo=https://github.com/OGGM/tutorials&urlpath=lab/tree/tutorials/./notebooks/merging_glaciers.ipynb&branch=master"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#set-up">
   Set-up
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pick-a-main-glacier-and-identify-all-its-possible-tributaries">
   Pick a main glacier and identify all its possible tributaries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merging-tributary-glaciers-to-a-main-glacier">
   Merging tributary glaciers to a main glacier
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#influence-on-glacier-advance">
   Influence on glacier advance
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#influence-on-glacier-retreat">
   Influence on glacier retreat
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#known-problems-future-improvements-and-limitations">
   Known problems, future improvements and limitations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-s-next">
   What’s next?
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="merging-glaciers-for-past-climate-simulations">
<h1>Merging glaciers for past climate simulations<a class="headerlink" href="#merging-glaciers-for-past-climate-simulations" title="Permalink to this headline">¶</a></h1>
<p>OGGM initializes glaciers based on <a class="reference external" href="https://www.glims.org/RGI/">RGI outlines</a> which allows for fully automated simulations starting from a recent global glacier state. OGGM also treats every glacier as entity which basically means that individual glaciers do not know about each other even if they are modelled within one specific run.</p>
<p>This is a good approach for current and future simulations in a warming climate where we mainly expect glacier retreat. But if we want to look at colder climates, either from the past or in a synthetic way, we might have to adjust this glacier centric view and take the influence of neighbouring glaciers into account.</p>
<p>In this notebook we show how OGGM can merge several neighbouring glaciers into one coupled glacier system. The general approach for this is to view the surrounding glaciers in the same way as tributary <a class="reference external" href="https://docs.oggm.org/en/latest/flowlines.html">flowlines</a> to an existing glacier entity.</p>
<p><strong>But before using this method please be aware of its limitations:</strong> We are only able to merge glaciers which are present in the Randolph Glacier Inventory. This limits the time we can go back into the past as we are not able to <em>create</em> a glacier with OGGM at a place where there is no glacier today. The merging procedure was developed with typcial Alpine valley glaciers and their extends around the Little Ice Age in mind. We did not develop this with glacial time scales in mind and <a class="reference external" href="https://docs.oggm.org/en/latest/faq.html#can-i-use-oggm-to-simulate-long-term-glacier-evolution">this statement about long term glacier evolution</a> still holds up.</p>
<div class="section" id="set-up">
<h2>Set-up<a class="headerlink" href="#set-up" title="Permalink to this headline">¶</a></h2>
<p>These are the usual OGGM workflow commands.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">oggm</span> <span class="kn">import</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">utils</span><span class="p">,</span> <span class="n">workflow</span><span class="p">,</span> <span class="n">tasks</span><span class="p">,</span> <span class="n">graphics</span>
<span class="kn">from</span> <span class="nn">oggm.core.flowline</span> <span class="kn">import</span> <span class="n">FileModel</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set-up</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">logging_level</span><span class="o">=</span><span class="s1">&#39;WARNING&#39;</span><span class="p">)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;working_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">(</span><span class="n">dirname</span><span class="o">=</span><span class="s1">&#39;OGGM-merging&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Use a suitable border size for your domain</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;border&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">80</span>
<span class="c1"># This is useful here</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;use_multiprocessing&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:22: oggm.cfg: Reading default parameters from the OGGM `params.cfg` configuration file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:22: oggm.cfg: Multiprocessing switched OFF according to the parameter file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:22: oggm.cfg: Multiprocessing: using all available processors (N=8)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:22: oggm.cfg: PARAMS[&#39;border&#39;] changed from `20` to `80`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:22: oggm.cfg: Multiprocessing switched ON after user settings.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="pick-a-main-glacier-and-identify-all-its-possible-tributaries">
<h2>Pick a main glacier and identify all its possible tributaries<a class="headerlink" href="#pick-a-main-glacier-and-identify-all-its-possible-tributaries" title="Permalink to this headline">¶</a></h2>
<p>In this case we are looking at Mont Mine Glacier (<code class="docutils literal notranslate"><span class="pre">RGI60-11.02709</span></code>) as our main glacier of interest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">montmine</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">init_glacier_directories</span><span class="p">([</span><span class="s1">&#39;RGI60-11.02709&#39;</span><span class="p">],</span> <span class="n">from_prepro_level</span><span class="o">=</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:22: oggm.workflow: init_glacier_directories from prepro level 3 on 1 glaciers.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:22: oggm.workflow: Execute entity task gdir_from_prepro on 1 glaciers
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">graphics</span><span class="o">.</span><span class="n">plot_centerlines</span><span class="p">(</span><span class="n">montmine</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">use_flowlines</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/merging_glaciers_9_0.png" src="../_images/merging_glaciers_9_0.png" />
</div>
</div>
<p>At the moment it is not possible to automatically search for tributary glaciers but this is planed for a later release.</p>
<p>Right now we have to provide all <strong>possible</strong> tributary glaciers as OGGM GlacierDirectories. “Possible” because OGGM will check if the provided glaciers will actually flow together with the main glacier by intersecting their downstream flowlines. If a “false” glacier is provided, it will not be merged.</p>
<p>The easiest way to obtain the GlacierDirectories is by using <a class="reference external" href="http://docs.oggm.org/en/latest/input-data.html#pre-processed-directories">preprocessed glacier directories</a>, initialized with a list of RGI-IDs. The list of RGI-IDs can be manually made. Another way, more suitable for larger glacier complexes would be to extract the RGI-IDs directly from a RGI shapefile.
For the Mont Mine example we provide a subset, containing the surrounding glaciers.</p>
<p>That way it is possible to select and extract a region of interest from the RGI within a GIS software. OGGM will then test and merge all glacieres of this subset and use the feasible ones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tfile</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">file_downloader</span><span class="p">(</span><span class="s2">&quot;https://cluster.klima.uni-bremen.de/~oggm/tutorials/montmine_shapefile.tar&quot;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">robust_tar_extract</span><span class="p">(</span><span class="n">tfile</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;working_dir&#39;</span><span class="p">],</span> <span class="s1">&#39;shapefile/&#39;</span><span class="p">))</span>
<span class="n">basin</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">PATHS</span><span class="p">[</span><span class="s1">&#39;working_dir&#39;</span><span class="p">],</span> <span class="s1">&#39;shapefile&#39;</span><span class="p">,</span> <span class="s1">&#39;mont_mine.shp&#39;</span><span class="p">))</span>

<span class="c1"># plot and highlight Mont Mine glacier in green</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">basin</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">basin</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">basin</span><span class="o">.</span><span class="n">RGIId</span><span class="o">==</span><span class="s1">&#39;RGI60-11.02709&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/merging_glaciers_11_0.png" src="../_images/merging_glaciers_11_0.png" />
</div>
</div>
<p>We can now use these RGI-IDs to initialize the OGGM GlacierDirectories.</p>
<p>In order to merge the glaciers we need the model flowlines and other files from <strong>preprocessing level 3</strong> which will be used by the dynamical model. The border size depends upon the specific topography and on how much glacier growth is expected. For the Mont Mine setting a border of 80 is sufficient.</p>
<p>Note that we also have to include the main glacier (Mont Mine glacier in this case) in the list of RGI-IDs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This can take some time</span>
<span class="n">gdirs</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">init_glacier_directories</span><span class="p">(</span><span class="n">basin</span><span class="o">.</span><span class="n">RGIId</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">from_prepro_level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">execute_entity_task</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">init_present_time_glacier</span><span class="p">,</span> <span class="n">gdirs</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:25: oggm.workflow: init_glacier_directories from prepro level 3 on 16 glaciers.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:25: oggm.workflow: Execute entity task gdir_from_prepro on 16 glaciers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:26: oggm.workflow: Execute entity task init_present_time_glacier on 16 glaciers
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="merging-tributary-glaciers-to-a-main-glacier">
<h2>Merging tributary glaciers to a main glacier<a class="headerlink" href="#merging-tributary-glaciers-to-a-main-glacier" title="Permalink to this headline">¶</a></h2>
<p>The merging process is fully automated done with the function <code class="docutils literal notranslate"><span class="pre">workflow.merge_glacier_tasks</span></code>.
It needs at least a list of OGGM GlacierDirectories, which contains all possible tributaries <strong>and</strong> the main glacier.
If as second argument a specific RGI ID is provided as string, this will be used to identify the main glacier of interest and all tributary glaciers are merged to this one. If no RGI ID is provided, OGGM will use the largest glacier as the main one. In the latter case the return value of the function is not a single GlacierDirectory but a list of GlacierDirectories containing all remaining glaciers, merged as much as possible.</p>
<p>This function also takes additional arguments to use custom climate data. The procedure for this would be to first run the necessary climate tasks on the individual glaciers and afterwards merge the glaciers to one complex. See the <a class="reference external" href="http://docs.oggm.org/en/latest/generated/oggm.workflow.merge_glacier_tasks.html">API</a> for details.</p>
<p><code class="docutils literal notranslate"><span class="pre">workflow.merge_glacier_tasks</span></code> performs three important tasks:</p>
<ol class="simple">
<li><p>Starting from either the main or the largest glacier it checks if its downstream flowline intersects with the downstream flowlines of all other glaciers provided within the list.</p></li>
<li><p>It initializes a new OGGM GlacierDirectory for the merged glacier. This new glacier will have the RGI-ID of the main glacier with the suffix ‘_merged’. E.g. <code class="docutils literal notranslate"><span class="pre">RGI60-11.02709_merged</span></code> in this example.</p></li>
<li><p>It merges the tributary glaciers (identified in step 1) to the main glacier.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cfg</span><span class="o">.</span><span class="n">PARAMS</span><span class="p">[</span><span class="s1">&#39;use_intersects&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">gdirs_merged</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">merge_glacier_tasks</span><span class="p">(</span><span class="n">gdirs</span><span class="p">,</span> <span class="s1">&#39;RGI60-11.02709&#39;</span><span class="p">,</span> <span class="n">return_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;climate_historical&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:26: oggm.cfg: PARAMS[&#39;use_intersects&#39;] changed from `True` to `False`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:29: oggm.cfg: PARAMS[&#39;grid_dx_method&#39;] changed from `square` to `fixed`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:29: oggm.cfg: PARAMS[&#39;fixed_dx&#39;] changed from `50.0` to `52.0`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:31: oggm.cfg: PARAMS[&#39;grid_dx_method&#39;] changed from `fixed` to `square`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:31: oggm.cfg: PARAMS[&#39;fixed_dx&#39;] changed from `52.0` to `50.0`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:32: oggm.cfg: PARAMS[&#39;grid_dx_method&#39;] changed from `square` to `fixed`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:32: oggm.cfg: PARAMS[&#39;fixed_dx&#39;] changed from `50.0` to `17.0`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:32: oggm.cfg: PARAMS[&#39;grid_dx_method&#39;] changed from `fixed` to `square`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:32: oggm.cfg: PARAMS[&#39;fixed_dx&#39;] changed from `17.0` to `50.0`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:33: oggm.cfg: PARAMS[&#39;grid_dx_method&#39;] changed from `square` to `fixed`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:33: oggm.cfg: PARAMS[&#39;fixed_dx&#39;] changed from `50.0` to `55.0`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:35: oggm.cfg: PARAMS[&#39;grid_dx_method&#39;] changed from `fixed` to `square`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:35: oggm.cfg: PARAMS[&#39;fixed_dx&#39;] changed from `55.0` to `50.0`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:36: oggm.cfg: PARAMS[&#39;grid_dx_method&#39;] changed from `square` to `fixed`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:36: oggm.cfg: PARAMS[&#39;fixed_dx&#39;] changed from `50.0` to `13.0`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:37: oggm.cfg: PARAMS[&#39;grid_dx_method&#39;] changed from `fixed` to `square`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:37: oggm.cfg: PARAMS[&#39;fixed_dx&#39;] changed from `13.0` to `50.0`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:38: oggm.cfg: PARAMS[&#39;grid_dx_method&#39;] changed from `square` to `fixed`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:38: oggm.cfg: PARAMS[&#39;fixed_dx&#39;] changed from `50.0` to `15.0`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:39: oggm.cfg: PARAMS[&#39;grid_dx_method&#39;] changed from `fixed` to `square`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-07 22:30:39: oggm.cfg: PARAMS[&#39;fixed_dx&#39;] changed from `15.0` to `50.0`.
</pre></div>
</div>
</div>
</div>
<p>Let’s have a look at the now merged glacier complex and compare it with the selected glaciers from the RGI shapefile:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">graphics</span><span class="o">.</span><span class="n">plot_centerlines</span><span class="p">(</span><span class="n">gdirs_merged</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">use_model_flowlines</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">graphics</span><span class="o">.</span><span class="n">plot_centerlines</span><span class="p">(</span><span class="n">gdirs_merged</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">use_model_flowlines</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">basin</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">basin</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">basin</span><span class="o">.</span><span class="n">RGIId</span><span class="o">==</span><span class="s1">&#39;RGI60-11.02709&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">);</span>
    
<span class="k">for</span> <span class="n">rgiid</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;RGI60-11.02772&#39;</span><span class="p">,</span> <span class="s1">&#39;RGI60-11.02789&#39;</span><span class="p">,</span> <span class="s1">&#39;RGI60-11.02756&#39;</span><span class="p">,</span> <span class="s1">&#39;RGI60-11.02778&#39;</span><span class="p">,</span> <span class="s1">&#39;RGI60-11.02779&#39;</span><span class="p">,</span> <span class="s1">&#39;RGI60-11.02768&#39;</span><span class="p">]:</span>
    <span class="n">basin</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">basin</span><span class="o">.</span><span class="n">RGIId</span><span class="o">==</span><span class="n">rgiid</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">);</span>    

<span class="n">basin</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">basin</span><span class="o">.</span><span class="n">RGIId</span><span class="o">==</span><span class="s1">&#39;RGI60-11.02701&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/merging_glaciers_18_0.png" src="../_images/merging_glaciers_18_0.png" />
</div>
</div>
<p>We see that several glaciers are now part of one big glacier complex, but we are also missing some:</p>
<ul class="simple">
<li><p>The green glacier ist our main glacier Mont Mine</p></li>
<li><p>The blue glaciers are succesfully merged to the main glacier. Either directly or first to another glacier which itself tributes to Mont Mine.</p></li>
<li><p>The orange glaciers do not flow into the same valley as Mont Mine glacier and were therefor correctly dismissed</p></li>
<li><p>The red glacier could have been merged to Mont Mine, but it is small and to far away so its downstream line within its individual domain does not reach the downstream line of Mont Mine. It would be possible to solve this by using higher border values for this glacier.</p></li>
</ul>
</div>
<div class="section" id="influence-on-glacier-advance">
<h2>Influence on glacier advance<a class="headerlink" href="#influence-on-glacier-advance" title="Permalink to this headline">¶</a></h2>
<p>Merging two or more glaciers might become relevant for scenarios where you might expect an influence(or more specific: <strong>mass contribution</strong>) from one glacier to another. To test this effect we can model our main glacier Mont Mine as single <em>“entity”</em> glacier and a merged glacier complex.</p>
<p>We do this with constant climate but with a rather strong negative temperatur bias of -1°C. This will lead to a rapid glacier advance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># some model settings</span>
<span class="n">years</span> <span class="o">=</span> <span class="mi">125</span>
<span class="n">tbias</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.5</span>

<span class="c1"># model Mont Mine glacier as entity and complile the output</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">run_constant_climate</span><span class="p">(</span><span class="n">montmine</span><span class="p">,</span> <span class="n">nyears</span><span class="o">=</span><span class="n">years</span><span class="p">,</span> <span class="n">output_filesuffix</span><span class="o">=</span><span class="s1">&#39;_entity&#39;</span><span class="p">,</span> <span class="n">temperature_bias</span><span class="o">=</span><span class="n">tbias</span><span class="p">)</span>
<span class="n">ds_entity</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">compile_run_output</span><span class="p">([</span><span class="n">montmine</span><span class="p">],</span> <span class="n">path</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filesuffix</span><span class="o">=</span><span class="s1">&#39;_entity&#39;</span><span class="p">)</span>

<span class="c1"># model the merged glacier and complile the output</span>
<span class="n">tasks</span><span class="o">.</span><span class="n">run_constant_climate</span><span class="p">(</span><span class="n">gdirs_merged</span><span class="p">,</span> <span class="n">nyears</span><span class="o">=</span><span class="n">years</span><span class="p">,</span> <span class="n">output_filesuffix</span><span class="o">=</span><span class="s1">&#39;_merged&#39;</span><span class="p">,</span> <span class="n">temperature_bias</span><span class="o">=</span><span class="n">tbias</span><span class="p">,</span> <span class="n">climate_filename</span><span class="o">=</span><span class="s1">&#39;climate_historical&#39;</span><span class="p">)</span>
<span class="n">ds_merged</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">compile_run_output</span><span class="p">([</span><span class="n">gdirs_merged</span><span class="p">],</span> <span class="n">path</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filesuffix</span><span class="o">=</span><span class="s1">&#39;_merged&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">graphics</span><span class="o">.</span><span class="n">plot_modeloutput_map</span><span class="p">(</span><span class="n">montmine</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">filesuffix</span><span class="o">=</span><span class="s1">&#39;_entity&#39;</span><span class="p">,</span> <span class="n">modelyr</span><span class="o">=</span><span class="n">years</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;entity&#39;</span><span class="p">);</span>
<span class="n">graphics</span><span class="o">.</span><span class="n">plot_modeloutput_map</span><span class="p">(</span><span class="n">gdirs_merged</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">filesuffix</span><span class="o">=</span><span class="s1">&#39;_merged&#39;</span><span class="p">,</span> <span class="n">modelyr</span><span class="o">=</span><span class="n">years</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;merged&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/merging_glaciers_23_0.png" src="../_images/merging_glaciers_23_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="n">dse</span> <span class="o">=</span> <span class="n">ds_entity</span><span class="o">.</span><span class="n">length</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">dsm</span> <span class="o">=</span> <span class="n">ds_merged</span><span class="o">.</span><span class="n">length</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dse</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Entity glacier&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dsm</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Merged glacier&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Simulation time [years]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Glacier length[meters]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/merging_glaciers_24_0.png" src="../_images/merging_glaciers_24_0.png" />
</div>
</div>
<p>The difference betwee the two simulations is not immediately visible from the topographic plots as the domains are slightly different. But if we compare the glacier length change we see that after ~20 years in this climate scenario the merged glacier advances with a stronger rate. Around this point the tongues of Mont Mine and Ferpecle glacier in the east connect to one common tongue.</p>
<p>And after around 90 years the merged glacier shows an additional small advance. At that point some of the smaller tributary glaciers start to contribute mass.</p>
</div>
<div class="section" id="influence-on-glacier-retreat">
<h2>Influence on glacier retreat<a class="headerlink" href="#influence-on-glacier-retreat" title="Permalink to this headline">¶</a></h2>
<p>We can also look at what influence a merged glacier has on glacier retreat.
For this we first try to grow the entity glacier to the same length as the merged glacer with a more negative temperature bias:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># some model settings</span>
<span class="n">tbias</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.25</span>
<span class="n">years</span> <span class="o">=</span> <span class="mi">125</span>

<span class="n">tasks</span><span class="o">.</span><span class="n">run_constant_climate</span><span class="p">(</span><span class="n">montmine</span><span class="p">,</span> <span class="n">nyears</span><span class="o">=</span><span class="n">years</span><span class="p">,</span> <span class="n">output_filesuffix</span><span class="o">=</span><span class="s1">&#39;_entity1&#39;</span><span class="p">,</span> <span class="n">temperature_bias</span><span class="o">=</span><span class="n">tbias</span><span class="p">)</span>
<span class="n">ds_entity1</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">compile_run_output</span><span class="p">([</span><span class="n">montmine</span><span class="p">],</span> <span class="n">path</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filesuffix</span><span class="o">=</span><span class="s1">&#39;_entity1&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-03 13:53:23: oggm.utils: Applying compile_run_output on 1 gdirs.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="n">dse1</span> <span class="o">=</span> <span class="n">ds_entity1</span><span class="o">.</span><span class="n">length</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dse1</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Entity glacier&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dsm</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Merged glacier&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Simulation time [years]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Glacier length [meters]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/merging_glaciers_29_0.png" src="../_images/merging_glaciers_29_0.png" />
</div>
</div>
<p>Now when both glaciers have roughly the same length we can let them shrink with a slightly warmer climate than before.
For this we use the simulated glacier extends from the previous runs and then apply the an identical climate to both glaciers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># some model settings</span>
<span class="n">tbias</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span>
<span class="n">years</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># load the previous entity run </span>
<span class="n">tmp_mine</span> <span class="o">=</span> <span class="n">FileModel</span><span class="p">(</span><span class="n">montmine</span><span class="o">.</span><span class="n">get_filepath</span><span class="p">(</span><span class="s1">&#39;model_run&#39;</span><span class="p">,</span> <span class="n">filesuffix</span><span class="o">=</span><span class="s1">&#39;_entity1&#39;</span><span class="p">))</span>
<span class="n">tmp_mine</span><span class="o">.</span><span class="n">run_until</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>

<span class="n">tasks</span><span class="o">.</span><span class="n">run_constant_climate</span><span class="p">(</span><span class="n">montmine</span><span class="p">,</span> <span class="n">nyears</span><span class="o">=</span><span class="n">years</span><span class="p">,</span> <span class="n">output_filesuffix</span><span class="o">=</span><span class="s1">&#39;_entity2&#39;</span><span class="p">,</span> <span class="n">init_model_fls</span><span class="o">=</span><span class="n">tmp_mine</span><span class="o">.</span><span class="n">fls</span><span class="p">,</span><span class="n">temperature_bias</span><span class="o">=</span><span class="n">tbias</span><span class="p">)</span>
<span class="n">ds_entity2</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">compile_run_output</span><span class="p">([</span><span class="n">montmine</span><span class="p">],</span> <span class="n">path</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filesuffix</span><span class="o">=</span><span class="s1">&#39;_entity2&#39;</span><span class="p">);</span>

<span class="c1"># model the merged glacier and complile the output</span>
<span class="n">tmp_merged</span> <span class="o">=</span> <span class="n">FileModel</span><span class="p">(</span><span class="n">gdirs_merged</span><span class="o">.</span><span class="n">get_filepath</span><span class="p">(</span><span class="s1">&#39;model_run&#39;</span><span class="p">,</span> <span class="n">filesuffix</span><span class="o">=</span><span class="s1">&#39;_merged&#39;</span><span class="p">))</span>
<span class="n">tmp_merged</span><span class="o">.</span><span class="n">run_until</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>

<span class="n">tasks</span><span class="o">.</span><span class="n">run_constant_climate</span><span class="p">(</span><span class="n">gdirs_merged</span><span class="p">,</span> <span class="n">nyears</span><span class="o">=</span><span class="n">years</span><span class="p">,</span> <span class="n">output_filesuffix</span><span class="o">=</span><span class="s1">&#39;_merged2&#39;</span><span class="p">,</span> <span class="n">init_model_fls</span><span class="o">=</span><span class="n">tmp_merged</span><span class="o">.</span><span class="n">fls</span><span class="p">,</span> <span class="n">temperature_bias</span><span class="o">=</span><span class="n">tbias</span><span class="p">,</span>
                           <span class="n">climate_filename</span><span class="o">=</span><span class="s1">&#39;climate_historical&#39;</span><span class="p">)</span>
<span class="n">ds_merged2</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">compile_run_output</span><span class="p">([</span><span class="n">gdirs_merged</span><span class="p">],</span> <span class="n">path</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filesuffix</span><span class="o">=</span><span class="s1">&#39;_merged2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-02-03 13:54:51: oggm.utils: Applying compile_run_output on 1 gdirs.
2021-02-03 13:56:16: oggm.utils: Applying compile_run_output on 1 gdirs.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="n">dse2</span> <span class="o">=</span> <span class="n">ds_entity2</span><span class="o">.</span><span class="n">length</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">dsm2</span> <span class="o">=</span> <span class="n">ds_merged2</span><span class="o">.</span><span class="n">length</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dse2</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Entity glacier&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dsm2</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Merged glacier&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Simulation time [years]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Glacier length [meters]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/merging_glaciers_32_0.png" src="../_images/merging_glaciers_32_0.png" />
</div>
</div>
<p>Starting from roughly the same extend, the entity glacier retreats much faster than the merged one, especially during the first 20 years. After that the rates of retreat seem more similar. But it takes more then 80 years until both glaciers are back to the same extend.</p>
<p>Reaching the same extent in the end is to be exected, as the tributaries stop contributing mass to the merged Mont Mine at some point.</p>
</div>
<div class="section" id="known-problems-future-improvements-and-limitations">
<h2>Known problems, future improvements and limitations<a class="headerlink" href="#known-problems-future-improvements-and-limitations" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>In future OGGM should be able to automatically identify tributary glaciers in a given distance</p></li>
<li><p>Currently some glaciers are not merged as their downstream line does not reach the main glacier’s line. This is especially the case for smaller tributary glaciers, as their domain is also smaller.</p></li>
<li><p>Glacier length in OGGM is calculated as the glaciated length of the main flowline. Usually this will also work for merged glaciers. But there are scenarios where merging glaciers might produce unexpected results: If a tributary glacier is contributing mass to the main glaciers downstream flowline but the main glacier did not already advance up to the tributary glacier (or has retreated again) the OGGM glacier length will be the sum of all glaciated parts on the main flowline.</p></li>
<li><p>Glacier area and volume in OGGM are calculated from all parts of the individual glacier. For a merged glacier all tributary glaciers are added to the total area and volume, even if they are not or were never connected to the actual main glacier.</p></li>
</ul>
<p>Especially the last two points show that even if merging glaciers will become a fully automated task in OGGM it should not be used without carfully assessing the results. Model results for merged glaciers might contain logical errors which are not obvious if only pure numbers (e.g. volume change) are evaluated.</p>
</div>
<div class="section" id="what-s-next">
<h2>What’s next?<a class="headerlink" href="#what-s-next" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>return to the <a class="reference external" href="https://docs.oggm.org">OGGM documentation</a></p></li>
<li><p>back to the <a class="reference internal" href="welcome.html"><span class="doc std std-doc">table of contents</span></a></p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="kcalving_parameterization.html" title="previous page">The Oerlemans &amp; Nick frontal ablation parameterization in OGGM</a>
    <a class='right-next' id="next-link" href="use_your_own_inventory.html" title="next page">Using your our own glacier inventory with OGGM</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By OGGM e.V. and OGGM Contributors<br/>
        
          <div class="extra_footer">
            <p>
These notebooks are licensed under a <a href="https://github.com/OGGM/tutorials/blob/master/LICENSE.txt" target="_blank">BSD-3-Clause license</a>.
<br>
&copy; Copyright 2014-2020.
</p>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-106829797-2', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>